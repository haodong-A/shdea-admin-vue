import"./d3-transition@3.0.1_d3-selection@3.0.0-B83X84Tf.js";import"./d3-zoom@3.0.0-BZGMUjlT.js";import{h as p,c as D,i as te,k as M,f as k,a as ye,b as f,e as w,u as rr,v as N,r as Y,g as W,m as b,j as T,l as X,n as G,o as S,p as he,q as tr,s as ce,z as nr,w as H,x as V,y as U,A as ir,B as ne,C as $,D as ar,E as or,F as P,G as sr,H as dr}from"./lodash-es@4.17.21-D6PnhKvy.js";import{d as x}from"./d3-selection@3.0.0-C52G7wmG.js";import{l as ur,c as fr}from"./d3-shape@3.2.0-U0HymUHV.js";import{s as hr}from"./d3-fetch@3.0.1-BOsq7VnW.js";var cr="\0",I="\0",xe="";class E{constructor(r={}){this._isDirected=p(r,"directed")?r.directed:!0,this._isMultigraph=p(r,"multigraph")?r.multigraph:!1,this._isCompound=p(r,"compound")?r.compound:!1,this._label=void 0,this._defaultNodeLabelFn=D(void 0),this._defaultEdgeLabelFn=D(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[I]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(r){return this._label=r,this}graph(){return this._label}setDefaultNodeLabel(r){return te(r)||(r=D(r)),this._defaultNodeLabelFn=r,this}nodeCount(){return this._nodeCount}nodes(){return M(this._nodes)}sources(){var r=this;return k(this.nodes(),function(t){return ye(r._in[t])})}sinks(){var r=this;return k(this.nodes(),function(t){return ye(r._out[t])})}setNodes(r,t){var n=arguments,i=this;return f(r,function(a){n.length>1?i.setNode(a,t):i.setNode(a)}),this}setNode(r,t){return p(this._nodes,r)?(arguments.length>1&&(this._nodes[r]=t),this):(this._nodes[r]=arguments.length>1?t:this._defaultNodeLabelFn(r),this._isCompound&&(this._parent[r]=I,this._children[r]={},this._children[I][r]=!0),this._in[r]={},this._preds[r]={},this._out[r]={},this._sucs[r]={},++this._nodeCount,this)}node(r){return this._nodes[r]}hasNode(r){return p(this._nodes,r)}removeNode(r){var t=this;if(p(this._nodes,r)){var n=function(i){t.removeEdge(t._edgeObjs[i])};delete this._nodes[r],this._isCompound&&(this._removeFromParentsChildList(r),delete this._parent[r],f(this.children(r),function(i){t.setParent(i)}),delete this._children[r]),f(M(this._in[r]),n),delete this._in[r],delete this._preds[r],f(M(this._out[r]),n),delete this._out[r],delete this._sucs[r],--this._nodeCount}return this}setParent(r,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(w(t))t=I;else{t+="";for(var n=t;!w(n);n=this.parent(n))if(n===r)throw new Error("Setting "+t+" as parent of "+r+" would create a cycle");this.setNode(t)}return this.setNode(r),this._removeFromParentsChildList(r),this._parent[r]=t,this._children[t][r]=!0,this}_removeFromParentsChildList(r){delete this._children[this._parent[r]][r]}parent(r){if(this._isCompound){var t=this._parent[r];if(t!==I)return t}}children(r){if(w(r)&&(r=I),this._isCompound){var t=this._children[r];if(t)return M(t)}else{if(r===I)return this.nodes();if(this.hasNode(r))return[]}}predecessors(r){var t=this._preds[r];if(t)return M(t)}successors(r){var t=this._sucs[r];if(t)return M(t)}neighbors(r){var t=this.predecessors(r);if(t)return rr(t,this.successors(r))}isLeaf(r){var t;return this.isDirected()?t=this.successors(r):t=this.neighbors(r),t.length===0}filterNodes(r){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;f(this._nodes,function(o,s){r(s)&&t.setNode(s,o)}),f(this._edgeObjs,function(o){t.hasNode(o.v)&&t.hasNode(o.w)&&t.setEdge(o,n.edge(o))});var i={};function a(o){var s=n.parent(o);return s===void 0||t.hasNode(s)?(i[o]=s,s):s in i?i[s]:a(s)}return this._isCompound&&f(t.nodes(),function(o){t.setParent(o,a(o))}),t}setDefaultEdgeLabel(r){return te(r)||(r=D(r)),this._defaultEdgeLabelFn=r,this}edgeCount(){return this._edgeCount}edges(){return N(this._edgeObjs)}setPath(r,t){var n=this,i=arguments;return Y(r,function(a,o){return i.length>1?n.setEdge(a,o,t):n.setEdge(a,o),o}),this}setEdge(){var r,t,n,i,a=!1,o=arguments[0];typeof o=="object"&&o!==null&&"v"in o?(r=o.v,t=o.w,n=o.name,arguments.length===2&&(i=arguments[1],a=!0)):(r=o,t=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],a=!0)),r=""+r,t=""+t,w(n)||(n=""+n);var s=F(this._isDirected,r,t,n);if(p(this._edgeLabels,s))return a&&(this._edgeLabels[s]=i),this;if(!w(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(r),this.setNode(t),this._edgeLabels[s]=a?i:this._defaultEdgeLabelFn(r,t,n);var d=lr(this._isDirected,r,t,n);return r=d.v,t=d.w,Object.freeze(d),this._edgeObjs[s]=d,_e(this._preds[t],r),_e(this._sucs[r],t),this._in[t][s]=d,this._out[r][s]=d,this._edgeCount++,this}edge(r,t,n){var i=arguments.length===1?q(this._isDirected,arguments[0]):F(this._isDirected,r,t,n);return this._edgeLabels[i]}hasEdge(r,t,n){var i=arguments.length===1?q(this._isDirected,arguments[0]):F(this._isDirected,r,t,n);return p(this._edgeLabels,i)}removeEdge(r,t,n){var i=arguments.length===1?q(this._isDirected,arguments[0]):F(this._isDirected,r,t,n),a=this._edgeObjs[i];return a&&(r=a.v,t=a.w,delete this._edgeLabels[i],delete this._edgeObjs[i],Ee(this._preds[t],r),Ee(this._sucs[r],t),delete this._in[t][i],delete this._out[r][i],this._edgeCount--),this}inEdges(r,t){var n=this._in[r];if(n){var i=N(n);return t?k(i,function(a){return a.v===t}):i}}outEdges(r,t){var n=this._out[r];if(n){var i=N(n);return t?k(i,function(a){return a.w===t}):i}}nodeEdges(r,t){var n=this.inEdges(r,t);if(n)return n.concat(this.outEdges(r,t))}}E.prototype._nodeCount=0;E.prototype._edgeCount=0;function _e(e,r){e[r]?e[r]++:e[r]=1}function Ee(e,r){--e[r]||delete e[r]}function F(e,r,t,n){var i=""+r,a=""+t;if(!e&&i>a){var o=i;i=a,a=o}return i+xe+a+xe+(w(n)?cr:n)}function lr(e,r,t,n){var i=""+r,a=""+t;if(!e&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return n&&(s.name=n),s}function q(e,r){return F(e,r.v,r.w,r.name)}class vr{constructor(){var r={};r._next=r._prev=r,this._sentinel=r}dequeue(){var r=this._sentinel,t=r._prev;if(t!==r)return ke(t),t}enqueue(r){var t=this._sentinel;r._prev&&r._next&&ke(r),r._next=t._next,t._next._prev=r,t._next=r,r._prev=t}toString(){for(var r=[],t=this._sentinel,n=t._prev;n!==t;)r.push(JSON.stringify(n,pr)),n=n._prev;return"["+r.join(", ")+"]"}}function ke(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function pr(e,r){if(e!=="_next"&&e!=="_prev")return r}var gr=D(1);function mr(e,r){if(e.nodeCount()<=1)return[];var t=br(e,r||gr),n=wr(t.graph,t.buckets,t.zeroIdx);return W(b(n,function(i){return e.outEdges(i.v,i.w)}))}function wr(e,r,t){for(var n=[],i=r[r.length-1],a=r[0],o;e.nodeCount();){for(;o=a.dequeue();)Q(e,r,t,o);for(;o=i.dequeue();)Q(e,r,t,o);if(e.nodeCount()){for(var s=r.length-2;s>0;--s)if(o=r[s].dequeue(),o){n=n.concat(Q(e,r,t,o,!0));break}}}return n}function Q(e,r,t,n,i){var a=i?[]:void 0;return f(e.inEdges(n.v),function(o){var s=e.edge(o),d=e.node(o.v);i&&a.push({v:o.v,w:o.w}),d.out-=s,ie(r,t,d)}),f(e.outEdges(n.v),function(o){var s=e.edge(o),d=o.w,u=e.node(d);u.in-=s,ie(r,t,u)}),e.removeNode(n.v),a}function br(e,r){var t=new E,n=0,i=0;f(e.nodes(),function(s){t.setNode(s,{v:s,in:0,out:0})}),f(e.edges(),function(s){var d=t.edge(s.v,s.w)||0,u=r(s),h=d+u;t.setEdge(s.v,s.w,h),i=Math.max(i,t.node(s.v).out+=u),n=Math.max(n,t.node(s.w).in+=u)});var a=T(i+n+3).map(function(){return new vr}),o=n+1;return f(t.nodes(),function(s){ie(a,o,t.node(s))}),{graph:t,buckets:a,zeroIdx:o}}function ie(e,r,t){t.out?t.in?e[t.out-t.in+r].enqueue(t):e[e.length-1].enqueue(t):e[0].enqueue(t)}function yr(e){var r=e.graph().acyclicer==="greedy"?mr(e,t(e)):xr(e);f(r,function(n){var i=e.edge(n);e.removeEdge(n),i.forwardName=n.name,i.reversed=!0,e.setEdge(n.w,n.v,i,X("rev"))});function t(n){return function(i){return n.edge(i).weight}}}function xr(e){var r=[],t={},n={};function i(a){p(n,a)||(n[a]=!0,t[a]=!0,f(e.outEdges(a),function(o){p(t,o.w)?r.push(o):i(o.w)}),delete t[a])}return f(e.nodes(),i),r}function _r(e){f(e.edges(),function(r){var t=e.edge(r);if(t.reversed){e.removeEdge(r);var n=t.forwardName;delete t.reversed,delete t.forwardName,e.setEdge(r.w,r.v,t,n)}})}function O(e,r,t,n){var i;do i=X(n);while(e.hasNode(i));return t.dummy=r,e.setNode(i,t),i}function Er(e){var r=new E().setGraph(e.graph());return f(e.nodes(),function(t){r.setNode(t,e.node(t))}),f(e.edges(),function(t){var n=r.edge(t.v,t.w)||{weight:0,minlen:1},i=e.edge(t);r.setEdge(t.v,t.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),r}function Ae(e){var r=new E({multigraph:e.isMultigraph()}).setGraph(e.graph());return f(e.nodes(),function(t){e.children(t).length||r.setNode(t,e.node(t))}),f(e.edges(),function(t){r.setEdge(t,e.edge(t))}),r}function Ne(e,r){var t=e.x,n=e.y,i=r.x-t,a=r.y-n,o=e.width/2,s=e.height/2;if(!i&&!a)throw new Error("Not possible to find intersection inside of the rectangle");var d,u;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),d=s*i/a,u=s):(i<0&&(o=-o),d=o,u=o*a/i),{x:t+d,y:n+u}}function z(e){var r=b(T(De(e)+1),function(){return[]});return f(e.nodes(),function(t){var n=e.node(t),i=n.rank;w(i)||(r[i][n.order]=t)}),r}function kr(e){var r=G(b(e.nodes(),function(t){return e.node(t).rank}));f(e.nodes(),function(t){var n=e.node(t);p(n,"rank")&&(n.rank-=r)})}function Nr(e){var r=G(b(e.nodes(),function(a){return e.node(a).rank})),t=[];f(e.nodes(),function(a){var o=e.node(a).rank-r;t[o]||(t[o]=[]),t[o].push(a)});var n=0,i=e.graph().nodeRankFactor;f(t,function(a,o){w(a)&&o%i!==0?--n:n&&f(a,function(s){e.node(s).rank+=n})})}function Le(e,r,t,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=t,i.order=n),O(e,"border",i,r)}function De(e){return S(b(e.nodes(),function(r){var t=e.node(r).rank;if(!w(t))return t}))}function Lr(e,r){var t={lhs:[],rhs:[]};return f(e,function(n){r(n)?t.lhs.push(n):t.rhs.push(n)}),t}function Cr(e,r){return r()}function Ir(e){function r(t){var n=e.children(t),i=e.node(t);if(n.length&&f(n,r),p(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,o=i.maxRank+1;a<o;++a)Ce(e,"borderLeft","_bl",t,i,a),Ce(e,"borderRight","_br",t,i,a)}}f(e.children(),r)}function Ce(e,r,t,n,i,a){var o={width:0,height:0,rank:a,borderType:r},s=i[r][a-1],d=O(e,"border",o,t);i[r][a]=d,e.setParent(d,n),s&&e.setEdge(s,d,{weight:1})}function Tr(e){var r=e.graph().rankdir.toLowerCase();(r==="lr"||r==="rl")&&Fe(e)}function Sr(e){var r=e.graph().rankdir.toLowerCase();(r==="bt"||r==="rl")&&Rr(e),(r==="lr"||r==="rl")&&(Mr(e),Fe(e))}function Fe(e){f(e.nodes(),function(r){Ie(e.node(r))}),f(e.edges(),function(r){Ie(e.edge(r))})}function Ie(e){var r=e.width;e.width=e.height,e.height=r}function Rr(e){f(e.nodes(),function(r){J(e.node(r))}),f(e.edges(),function(r){var t=e.edge(r);f(t.points,J),p(t,"y")&&J(t)})}function J(e){e.y=-e.y}function Mr(e){f(e.nodes(),function(r){K(e.node(r))}),f(e.edges(),function(r){var t=e.edge(r);f(t.points,K),p(t,"x")&&K(t)})}function K(e){var r=e.x;e.x=e.y,e.y=r}function Pr(e){e.graph().dummyChains=[],f(e.edges(),function(r){Or(e,r)})}function Or(e,r){var t=r.v,n=e.node(t).rank,i=r.w,a=e.node(i).rank,o=r.name,s=e.edge(r),d=s.labelRank;if(a!==n+1){e.removeEdge(r);var u,h,c;for(c=0,++n;n<a;++c,++n)s.points=[],h={width:0,height:0,edgeLabel:s,edgeObj:r,rank:n},u=O(e,"edge",h,"_d"),n===d&&(h.width=s.width,h.height=s.height,h.dummy="edge-label",h.labelpos=s.labelpos),e.setEdge(t,u,{weight:s.weight},o),c===0&&e.graph().dummyChains.push(u),t=u;e.setEdge(t,i,{weight:s.weight},o)}}function Br(e){f(e.graph().dummyChains,function(r){var t=e.node(r),n=t.edgeLabel,i;for(e.setEdge(t.edgeObj,n);t.dummy;)i=e.successors(r)[0],e.removeNode(r),n.points.push({x:t.x,y:t.y}),t.dummy==="edge-label"&&(n.x=t.x,n.y=t.y,n.width=t.width,n.height=t.height),r=i,t=e.node(r)})}function le(e){var r={};function t(n){var i=e.node(n);if(p(r,n))return i.rank;r[n]=!0;var a=G(b(e.outEdges(n),function(o){return t(o.w)-e.edge(o).minlen}));return(a===Number.POSITIVE_INFINITY||a===void 0||a===null)&&(a=0),i.rank=a}f(e.sources(),t)}function j(e,r){return e.node(r.w).rank-e.node(r.v).rank-e.edge(r).minlen}function Ge(e){var r=new E({directed:!1}),t=e.nodes()[0],n=e.nodeCount();r.setNode(t,{});for(var i,a;Ar(r,e)<n;)i=Dr(r,e),a=r.hasNode(i.v)?j(e,i):-j(e,i),Fr(r,e,a);return r}function Ar(e,r){function t(n){f(r.nodeEdges(n),function(i){var a=i.v,o=n===a?i.w:a;!e.hasNode(o)&&!j(r,i)&&(e.setNode(o,{}),e.setEdge(n,o,{}),t(o))})}return f(e.nodes(),t),e.nodeCount()}function Dr(e,r){return he(r.edges(),function(t){if(e.hasNode(t.v)!==e.hasNode(t.w))return j(r,t)})}function Fr(e,r,t){f(e.nodes(),function(n){r.node(n).rank+=t})}function Gr(){}Gr.prototype=new Error;function Ve(e,r,t){tr(r)||(r=[r]);var n=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],a={};return f(r,function(o){if(!e.hasNode(o))throw new Error("Graph does not have node: "+o);je(e,o,t==="post",a,n,i)}),i}function je(e,r,t,n,i,a){p(n,r)||(n[r]=!0,t||a.push(r),f(i(r),function(o){je(e,o,t,n,i,a)}),t&&a.push(r))}function Vr(e,r){return Ve(e,r,"post")}function jr(e,r){return Ve(e,r,"pre")}R.initLowLimValues=pe;R.initCutValues=ve;R.calcCutValue=Ye;R.leaveEdge=He;R.enterEdge=Ue;R.exchangeEdges=Xe;function R(e){e=Er(e),le(e);var r=Ge(e);pe(r),ve(r,e);for(var t,n;t=He(r);)n=Ue(r,e,t),Xe(r,e,t,n)}function ve(e,r){var t=Vr(e,e.nodes());t=t.slice(0,t.length-1),f(t,function(n){Yr(e,r,n)})}function Yr(e,r,t){var n=e.node(t),i=n.parent;e.edge(t,i).cutvalue=Ye(e,r,t)}function Ye(e,r,t){var n=e.node(t),i=n.parent,a=!0,o=r.edge(t,i),s=0;return o||(a=!1,o=r.edge(i,t)),s=o.weight,f(r.nodeEdges(t),function(d){var u=d.v===t,h=u?d.w:d.v;if(h!==i){var c=u===a,l=r.edge(d).weight;if(s+=c?l:-l,Hr(e,t,h)){var g=e.edge(t,h).cutvalue;s+=c?-g:g}}}),s}function pe(e,r){arguments.length<2&&(r=e.nodes()[0]),We(e,{},1,r)}function We(e,r,t,n,i){var a=t,o=e.node(n);return r[n]=!0,f(e.neighbors(n),function(s){p(r,s)||(t=We(e,r,t,s,n))}),o.low=a,o.lim=t++,i?o.parent=i:delete o.parent,t}function He(e){return ce(e.edges(),function(r){return e.edge(r).cutvalue<0})}function Ue(e,r,t){var n=t.v,i=t.w;r.hasEdge(n,i)||(n=t.w,i=t.v);var a=e.node(n),o=e.node(i),s=a,d=!1;a.lim>o.lim&&(s=o,d=!0);var u=k(r.edges(),function(h){return d===Te(e,e.node(h.v),s)&&d!==Te(e,e.node(h.w),s)});return he(u,function(h){return j(r,h)})}function Xe(e,r,t,n){var i=t.v,a=t.w;e.removeEdge(i,a),e.setEdge(n.v,n.w,{}),pe(e),ve(e,r),Wr(e,r)}function Wr(e,r){var t=ce(e.nodes(),function(i){return!r.node(i).parent}),n=jr(e,t);n=n.slice(1),f(n,function(i){var a=e.node(i).parent,o=r.edge(i,a),s=!1;o||(o=r.edge(a,i),s=!0),r.node(i).rank=r.node(a).rank+(s?o.minlen:-o.minlen)})}function Hr(e,r,t){return e.hasEdge(r,t)}function Te(e,r,t){return t.low<=r.lim&&r.lim<=t.lim}function Ur(e){switch(e.graph().ranker){case"network-simplex":Se(e);break;case"tight-tree":$r(e);break;case"longest-path":Xr(e);break;default:Se(e)}}var Xr=le;function $r(e){le(e),Ge(e)}function Se(e){R(e)}function zr(e){var r=O(e,"root",{},"_root"),t=qr(e),n=S(N(t))-1,i=2*n+1;e.graph().nestingRoot=r,f(e.edges(),function(o){e.edge(o).minlen*=i});var a=Qr(e)+1;f(e.children(),function(o){$e(e,r,i,a,n,t,o)}),e.graph().nodeRankFactor=i}function $e(e,r,t,n,i,a,o){var s=e.children(o);if(!s.length){o!==r&&e.setEdge(r,o,{weight:0,minlen:t});return}var d=Le(e,"_bt"),u=Le(e,"_bb"),h=e.node(o);e.setParent(d,o),h.borderTop=d,e.setParent(u,o),h.borderBottom=u,f(s,function(c){$e(e,r,t,n,i,a,c);var l=e.node(c),g=l.borderTop?l.borderTop:c,v=l.borderBottom?l.borderBottom:c,m=l.borderTop?n:2*n,y=g!==v?1:i-a[o]+1;e.setEdge(d,g,{weight:m,minlen:y,nestingEdge:!0}),e.setEdge(v,u,{weight:m,minlen:y,nestingEdge:!0})}),e.parent(o)||e.setEdge(r,d,{weight:0,minlen:i+a[o]})}function qr(e){var r={};function t(n,i){var a=e.children(n);a&&a.length&&f(a,function(o){t(o,i+1)}),r[n]=i}return f(e.children(),function(n){t(n,1)}),r}function Qr(e){return Y(e.edges(),function(r,t){return r+e.edge(t).weight},0)}function Jr(e){var r=e.graph();e.removeNode(r.nestingRoot),delete r.nestingRoot,f(e.edges(),function(t){var n=e.edge(t);n.nestingEdge&&e.removeEdge(t)})}function Kr(e,r,t){var n={},i;f(t,function(a){for(var o=e.parent(a),s,d;o;){if(s=e.parent(o),s?(d=n[s],n[s]=o):(d=i,i=o),d&&d!==o){r.setEdge(d,o);return}o=s}})}function Zr(e,r,t){var n=et(e),i=new E({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(a){return e.node(a)});return f(e.nodes(),function(a){var o=e.node(a),s=e.parent(a);(o.rank===r||o.minRank<=r&&r<=o.maxRank)&&(i.setNode(a),i.setParent(a,s||n),f(e[t](a),function(d){var u=d.v===a?d.w:d.v,h=i.edge(u,a),c=w(h)?0:h.weight;i.setEdge(u,a,{weight:e.edge(d).weight+c})}),p(o,"minRank")&&i.setNode(a,{borderLeft:o.borderLeft[r],borderRight:o.borderRight[r]}))}),i}function et(e){for(var r;e.hasNode(r=X("_root")););return r}function rt(e,r){for(var t=0,n=1;n<r.length;++n)t+=tt(e,r[n-1],r[n]);return t}function tt(e,r,t){for(var n=nr(t,b(t,function(u,h){return h})),i=W(b(r,function(u){return H(b(e.outEdges(u),function(h){return{pos:n[h.w],weight:e.edge(h).weight}}),"pos")})),a=1;a<t.length;)a<<=1;var o=2*a-1;a-=1;var s=b(new Array(o),function(){return 0}),d=0;return f(i.forEach(function(u){var h=u.pos+a;s[h]+=u.weight;for(var c=0;h>0;)h%2&&(c+=s[h+1]),h=h-1>>1,s[h]+=u.weight;d+=u.weight*c})),d}function nt(e){var r={},t=k(e.nodes(),function(s){return!e.children(s).length}),n=S(b(t,function(s){return e.node(s).rank})),i=b(T(n+1),function(){return[]});function a(s){if(!p(r,s)){r[s]=!0;var d=e.node(s);i[d.rank].push(s),f(e.successors(s),a)}}var o=H(t,function(s){return e.node(s).rank});return f(o,a),i}function it(e,r){return b(r,function(t){var n=e.inEdges(t);if(n.length){var i=Y(n,function(a,o){var s=e.edge(o),d=e.node(o.v);return{sum:a.sum+s.weight*d.order,weight:a.weight+s.weight}},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:t}})}function at(e,r){var t={};f(e,function(i,a){var o=t[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:a};w(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),f(r.edges(),function(i){var a=t[i.v],o=t[i.w];!w(a)&&!w(o)&&(o.indegree++,a.out.push(t[i.w]))});var n=k(t,function(i){return!i.indegree});return ot(n)}function ot(e){var r=[];function t(a){return function(o){o.merged||(w(o.barycenter)||w(a.barycenter)||o.barycenter>=a.barycenter)&&st(a,o)}}function n(a){return function(o){o.in.push(a),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();r.push(i),f(i.in.reverse(),t(i)),f(i.out,n(i))}return b(k(r,function(a){return!a.merged}),function(a){return V(a,["vs","i","barycenter","weight"])})}function st(e,r){var t=0,n=0;e.weight&&(t+=e.barycenter*e.weight,n+=e.weight),r.weight&&(t+=r.barycenter*r.weight,n+=r.weight),e.vs=r.vs.concat(e.vs),e.barycenter=t/n,e.weight=n,e.i=Math.min(r.i,e.i),r.merged=!0}function dt(e,r){var t=Lr(e,function(h){return p(h,"barycenter")}),n=t.lhs,i=H(t.rhs,function(h){return-h.i}),a=[],o=0,s=0,d=0;n.sort(ut(!!r)),d=Re(a,i,d),f(n,function(h){d+=h.vs.length,a.push(h.vs),o+=h.barycenter*h.weight,s+=h.weight,d=Re(a,i,d)});var u={vs:W(a)};return s&&(u.barycenter=o/s,u.weight=s),u}function Re(e,r,t){for(var n;r.length&&(n=U(r)).i<=t;)r.pop(),e.push(n.vs),t++;return t}function ut(e){return function(r,t){return r.barycenter<t.barycenter?-1:r.barycenter>t.barycenter?1:e?t.i-r.i:r.i-t.i}}function ze(e,r,t,n){var i=e.children(r),a=e.node(r),o=a?a.borderLeft:void 0,s=a?a.borderRight:void 0,d={};o&&(i=k(i,function(v){return v!==o&&v!==s}));var u=it(e,i);f(u,function(v){if(e.children(v.v).length){var m=ze(e,v.v,t,n);d[v.v]=m,p(m,"barycenter")&&ht(v,m)}});var h=at(u,t);ft(h,d);var c=dt(h,n);if(o&&(c.vs=W([o,c.vs,s]),e.predecessors(o).length)){var l=e.node(e.predecessors(o)[0]),g=e.node(e.predecessors(s)[0]);p(c,"barycenter")||(c.barycenter=0,c.weight=0),c.barycenter=(c.barycenter*c.weight+l.order+g.order)/(c.weight+2),c.weight+=2}return c}function ft(e,r){f(e,function(t){t.vs=W(t.vs.map(function(n){return r[n]?r[n].vs:n}))})}function ht(e,r){w(e.barycenter)?(e.barycenter=r.barycenter,e.weight=r.weight):(e.barycenter=(e.barycenter*e.weight+r.barycenter*r.weight)/(e.weight+r.weight),e.weight+=r.weight)}function ct(e){var r=De(e),t=Me(e,T(1,r+1),"inEdges"),n=Me(e,T(r-1,-1,-1),"outEdges"),i=nt(e);Pe(e,i);for(var a=Number.POSITIVE_INFINITY,o,s=0,d=0;d<4;++s,++d){lt(s%2?t:n,s%4>=2),i=z(e);var u=rt(e,i);u<a&&(d=0,o=ir(i),a=u)}Pe(e,o)}function Me(e,r,t){return b(r,function(n){return Zr(e,n,t)})}function lt(e,r){var t=new E;f(e,function(n){var i=n.graph().root,a=ze(n,i,t,r);f(a.vs,function(o,s){n.node(o).order=s}),Kr(n,t,a.vs)})}function Pe(e,r){f(r,function(t){f(t,function(n,i){e.node(n).order=i})})}function vt(e){var r=gt(e);f(e.graph().dummyChains,function(t){for(var n=e.node(t),i=n.edgeObj,a=pt(e,r,i.v,i.w),o=a.path,s=a.lca,d=0,u=o[d],h=!0;t!==i.w;){if(n=e.node(t),h){for(;(u=o[d])!==s&&e.node(u).maxRank<n.rank;)d++;u===s&&(h=!1)}if(!h){for(;d<o.length-1&&e.node(u=o[d+1]).minRank<=n.rank;)d++;u=o[d]}e.setParent(t,u),t=e.successors(t)[0]}})}function pt(e,r,t,n){var i=[],a=[],o=Math.min(r[t].low,r[n].low),s=Math.max(r[t].lim,r[n].lim),d,u;d=t;do d=e.parent(d),i.push(d);while(d&&(r[d].low>o||s>r[d].lim));for(u=d,d=n;(d=e.parent(d))!==u;)a.push(d);return{path:i.concat(a.reverse()),lca:u}}function gt(e){var r={},t=0;function n(i){var a=t;f(e.children(i),n),r[i]={low:a,lim:t++}}return f(e.children(),n),r}function mt(e,r){var t={};function n(i,a){var o=0,s=0,d=i.length,u=U(a);return f(a,function(h,c){var l=bt(e,h),g=l?e.node(l).order:d;(l||h===u)&&(f(a.slice(s,c+1),function(v){f(e.predecessors(v),function(m){var y=e.node(m),C=y.order;(C<o||g<C)&&!(y.dummy&&e.node(v).dummy)&&qe(t,m,v)})}),s=c+1,o=g)}),a}return Y(r,n),t}function wt(e,r){var t={};function n(a,o,s,d,u){var h;f(T(o,s),function(c){h=a[c],e.node(h).dummy&&f(e.predecessors(h),function(l){var g=e.node(l);g.dummy&&(g.order<d||g.order>u)&&qe(t,l,h)})})}function i(a,o){var s=-1,d,u=0;return f(o,function(h,c){if(e.node(h).dummy==="border"){var l=e.predecessors(h);l.length&&(d=e.node(l[0]).order,n(o,u,c,s,d),u=c,s=d)}n(o,u,o.length,d,a.length)}),o}return Y(r,i),t}function bt(e,r){if(e.node(r).dummy)return ce(e.predecessors(r),function(t){return e.node(t).dummy})}function qe(e,r,t){if(r>t){var n=r;r=t,t=n}var i=e[r];i||(e[r]=i={}),i[t]=!0}function yt(e,r,t){if(r>t){var n=r;r=t,t=n}return p(e[r],t)}function xt(e,r,t,n){var i={},a={},o={};return f(r,function(s){f(s,function(d,u){i[d]=d,a[d]=d,o[d]=u})}),f(r,function(s){var d=-1;f(s,function(u){var h=n(u);if(h.length){h=H(h,function(m){return o[m]});for(var c=(h.length-1)/2,l=Math.floor(c),g=Math.ceil(c);l<=g;++l){var v=h[l];a[u]===u&&d<o[v]&&!yt(t,u,v)&&(a[v]=u,a[u]=i[u]=i[v],d=o[v])}}})}),{root:i,align:a}}function _t(e,r,t,n,i){var a={},o=Et(e,r,t,i),s=i?"borderLeft":"borderRight";function d(c,l){for(var g=o.nodes(),v=g.pop(),m={};v;)m[v]?c(v):(m[v]=!0,g.push(v),g=g.concat(l(v))),v=g.pop()}function u(c){a[c]=o.inEdges(c).reduce(function(l,g){return Math.max(l,a[g.v]+o.edge(g))},0)}function h(c){var l=o.outEdges(c).reduce(function(v,m){return Math.min(v,a[m.w]-o.edge(m))},Number.POSITIVE_INFINITY),g=e.node(c);l!==Number.POSITIVE_INFINITY&&g.borderType!==s&&(a[c]=Math.max(a[c],l))}return d(u,o.predecessors.bind(o)),d(h,o.successors.bind(o)),f(n,function(c){a[c]=a[t[c]]}),a}function Et(e,r,t,n){var i=new E,a=e.graph(),o=It(a.nodesep,a.edgesep,n);return f(r,function(s){var d;f(s,function(u){var h=t[u];if(i.setNode(h),d){var c=t[d],l=i.edge(c,h);i.setEdge(c,h,Math.max(o(e,u,d),l||0))}d=u})}),i}function kt(e,r){return he(N(r),function(t){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return ar(t,function(a,o){var s=Tt(e,o)/2;n=Math.max(a+s,n),i=Math.min(a-s,i)}),n-i})}function Nt(e,r){var t=N(r),n=G(t),i=S(t);f(["u","d"],function(a){f(["l","r"],function(o){var s=a+o,d=e[s],u;if(d!==r){var h=N(d);u=o==="l"?n-G(h):i-S(h),u&&(e[s]=$(d,function(c){return c+u}))}})})}function Lt(e,r){return $(e.ul,function(t,n){if(r)return e[r.toLowerCase()][n];var i=H(b(e,n));return(i[1]+i[2])/2})}function Ct(e){var r=z(e),t=ne(mt(e,r),wt(e,r)),n={},i;f(["u","d"],function(o){i=o==="u"?r:N(r).reverse(),f(["l","r"],function(s){s==="r"&&(i=b(i,function(c){return N(c).reverse()}));var d=(o==="u"?e.predecessors:e.successors).bind(e),u=xt(e,i,t,d),h=_t(e,i,u.root,u.align,s==="r");s==="r"&&(h=$(h,function(c){return-c})),n[o+s]=h})});var a=kt(e,n);return Nt(n,a),Lt(n,e.graph().align)}function It(e,r,t){return function(n,i,a){var o=n.node(i),s=n.node(a),d=0,u;if(d+=o.width/2,p(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":u=-o.width/2;break;case"r":u=o.width/2;break}if(u&&(d+=t?u:-u),u=0,d+=(o.dummy?r:e)/2,d+=(s.dummy?r:e)/2,d+=s.width/2,p(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":u=s.width/2;break;case"r":u=-s.width/2;break}return u&&(d+=t?u:-u),u=0,d}}function Tt(e,r){return e.node(r).width}function St(e){e=Ae(e),Rt(e),or(Ct(e),function(r,t){e.node(t).x=r})}function Rt(e){var r=z(e),t=e.graph().ranksep,n=0;f(r,function(i){var a=S(b(i,function(o){return e.node(o).height}));f(i,function(o){e.node(o).y=n+a/2}),n+=a+t})}function Mt(e,r){var t=Cr;t("layout",function(){var n=t("  buildLayoutGraph",function(){return Wt(e)});t("  runLayout",function(){Pt(n,t)}),t("  updateInputGraph",function(){Ot(e,n)})})}function Pt(e,r){r("    makeSpaceForEdgeLabels",function(){Ht(e)}),r("    removeSelfEdges",function(){Zt(e)}),r("    acyclic",function(){yr(e)}),r("    nestingGraph.run",function(){zr(e)}),r("    rank",function(){Ur(Ae(e))}),r("    injectEdgeLabelProxies",function(){Ut(e)}),r("    removeEmptyRanks",function(){Nr(e)}),r("    nestingGraph.cleanup",function(){Jr(e)}),r("    normalizeRanks",function(){kr(e)}),r("    assignRankMinMax",function(){Xt(e)}),r("    removeEdgeLabelProxies",function(){$t(e)}),r("    normalize.run",function(){Pr(e)}),r("    parentDummyChains",function(){vt(e)}),r("    addBorderSegments",function(){Ir(e)}),r("    order",function(){ct(e)}),r("    insertSelfEdges",function(){en(e)}),r("    adjustCoordinateSystem",function(){Tr(e)}),r("    position",function(){St(e)}),r("    positionSelfEdges",function(){rn(e)}),r("    removeBorderNodes",function(){Kt(e)}),r("    normalize.undo",function(){Br(e)}),r("    fixupEdgeLabelCoords",function(){Qt(e)}),r("    undoCoordinateSystem",function(){Sr(e)}),r("    translateGraph",function(){zt(e)}),r("    assignNodeIntersects",function(){qt(e)}),r("    reversePoints",function(){Jt(e)}),r("    acyclic.undo",function(){_r(e)})}function Ot(e,r){f(e.nodes(),function(t){var n=e.node(t),i=r.node(t);n&&(n.x=i.x,n.y=i.y,r.children(t).length&&(n.width=i.width,n.height=i.height))}),f(e.edges(),function(t){var n=e.edge(t),i=r.edge(t);n.points=i.points,p(i,"x")&&(n.x=i.x,n.y=i.y)}),e.graph().width=r.graph().width,e.graph().height=r.graph().height}var Bt=["nodesep","edgesep","ranksep","marginx","marginy"],At={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Dt=["acyclicer","ranker","rankdir","align"],Ft=["width","height"],Gt={width:0,height:0},Vt=["minlen","weight","width","height","labeloffset"],jt={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Yt=["labelpos"];function Wt(e){var r=new E({multigraph:!0,compound:!0}),t=ee(e.graph());return r.setGraph(ne({},At,Z(t,Bt),V(t,Dt))),f(e.nodes(),function(n){var i=ee(e.node(n));r.setNode(n,P(Z(i,Ft),Gt)),r.setParent(n,e.parent(n))}),f(e.edges(),function(n){var i=ee(e.edge(n));r.setEdge(n,ne({},jt,Z(i,Vt),V(i,Yt)))}),r}function Ht(e){var r=e.graph();r.ranksep/=2,f(e.edges(),function(t){var n=e.edge(t);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(r.rankdir==="TB"||r.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function Ut(e){f(e.edges(),function(r){var t=e.edge(r);if(t.width&&t.height){var n=e.node(r.v),i=e.node(r.w),a={rank:(i.rank-n.rank)/2+n.rank,e:r};O(e,"edge-proxy",a,"_ep")}})}function Xt(e){var r=0;f(e.nodes(),function(t){var n=e.node(t);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,r=S(r,n.maxRank))}),e.graph().maxRank=r}function $t(e){f(e.nodes(),function(r){var t=e.node(r);t.dummy==="edge-proxy"&&(e.edge(t.e).labelRank=t.rank,e.removeNode(r))})}function zt(e){var r=Number.POSITIVE_INFINITY,t=0,n=Number.POSITIVE_INFINITY,i=0,a=e.graph(),o=a.marginx||0,s=a.marginy||0;function d(u){var h=u.x,c=u.y,l=u.width,g=u.height;r=Math.min(r,h-l/2),t=Math.max(t,h+l/2),n=Math.min(n,c-g/2),i=Math.max(i,c+g/2)}f(e.nodes(),function(u){d(e.node(u))}),f(e.edges(),function(u){var h=e.edge(u);p(h,"x")&&d(h)}),r-=o,n-=s,f(e.nodes(),function(u){var h=e.node(u);h.x-=r,h.y-=n}),f(e.edges(),function(u){var h=e.edge(u);f(h.points,function(c){c.x-=r,c.y-=n}),p(h,"x")&&(h.x-=r),p(h,"y")&&(h.y-=n)}),a.width=t-r+o,a.height=i-n+s}function qt(e){f(e.edges(),function(r){var t=e.edge(r),n=e.node(r.v),i=e.node(r.w),a,o;t.points?(a=t.points[0],o=t.points[t.points.length-1]):(t.points=[],a=i,o=n),t.points.unshift(Ne(n,a)),t.points.push(Ne(i,o))})}function Qt(e){f(e.edges(),function(r){var t=e.edge(r);if(p(t,"x"))switch((t.labelpos==="l"||t.labelpos==="r")&&(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset;break}})}function Jt(e){f(e.edges(),function(r){var t=e.edge(r);t.reversed&&t.points.reverse()})}function Kt(e){f(e.nodes(),function(r){if(e.children(r).length){var t=e.node(r),n=e.node(t.borderTop),i=e.node(t.borderBottom),a=e.node(U(t.borderLeft)),o=e.node(U(t.borderRight));t.width=Math.abs(o.x-a.x),t.height=Math.abs(i.y-n.y),t.x=a.x+t.width/2,t.y=n.y+t.height/2}}),f(e.nodes(),function(r){e.node(r).dummy==="border"&&e.removeNode(r)})}function Zt(e){f(e.edges(),function(r){if(r.v===r.w){var t=e.node(r.v);t.selfEdges||(t.selfEdges=[]),t.selfEdges.push({e:r,label:e.edge(r)}),e.removeEdge(r)}})}function en(e){var r=z(e);f(r,function(t){var n=0;f(t,function(i,a){var o=e.node(i);o.order=a+n,f(o.selfEdges,function(s){O(e,"selfedge",{width:s.label.width,height:s.label.height,rank:o.rank,order:a+ ++n,e:s.e,label:s.label},"_se")}),delete o.selfEdges})})}function rn(e){f(e.nodes(),function(r){var t=e.node(r);if(t.dummy==="selfedge"){var n=e.node(t.e.v),i=n.x+n.width/2,a=n.y,o=t.x-i,s=n.height/2;e.setEdge(t.e,t.label),e.removeNode(r),t.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],t.label.x=t.x,t.label.y=t.y}})}function Z(e,r){return $(V(e,r),Number)}function ee(e){var r={};return f(e,function(t,n){r[n.toLowerCase()]=t}),r}function Qe(e,r){return!!e.children(r).length}function Je(e){return re(e.v)+":"+re(e.w)+":"+re(e.name)}var tn=/:/g;function re(e){return e?String(e).replace(tn,"\\:"):""}function L(e,r){r&&e.attr("style",r)}function Ke(e,r,t){r&&e.attr("class",r).attr("class",t+" "+e.attr("class"))}function _(e,r){var t=r.graph();if(sr(t)){var n=t.transition;if(te(n))return n(e)}return e}var ae={normal:an,vee:on,undirected:sn};function nn(e){ae=e}function an(e,r,t,n){var i=e.append("marker").attr("id",r).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),a=i.append("path").attr("d","M 0 0 L 10 5 L 0 10 z").style("stroke-width",1).style("stroke-dasharray","1,0");L(a,t[n+"Style"]),t[n+"Class"]&&a.attr("class",t[n+"Class"])}function on(e,r,t,n){var i=e.append("marker").attr("id",r).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),a=i.append("path").attr("d","M 0 0 L 10 5 L 0 10 L 4 5 z").style("stroke-width",1).style("stroke-dasharray","1,0");L(a,t[n+"Style"]),t[n+"Class"]&&a.attr("class",t[n+"Class"])}function sn(e,r,t,n){var i=e.append("marker").attr("id",r).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),a=i.append("path").attr("d","M 0 5 L 10 5").style("stroke-width",1).style("stroke-dasharray","1,0");L(a,t[n+"Style"]),t[n+"Class"]&&a.attr("class",t[n+"Class"])}function dn(e,r){var t=e.append("foreignObject").attr("width","100000"),n=t.append("xhtml:div");n.attr("xmlns","http://www.w3.org/1999/xhtml");var i=r.label;switch(typeof i){case"function":n.insert(i);break;case"object":n.insert(function(){return i});break;default:n.html(i)}L(n,r.labelStyle),n.style("display","inline-block"),n.style("white-space","nowrap");var a=n.node().getBoundingClientRect();return t.attr("width",a.width).attr("height",a.height),t}function un(e,r){var t=e;return t.node().appendChild(r.label),L(t,r.labelStyle),t}function fn(e,r){for(var t=e.append("text"),n=hn(r.label).split(`
`),i=0;i<n.length;i++)t.append("tspan").attr("xml:space","preserve").attr("dy","1em").attr("x","1").text(n[i]);return L(t,r.labelStyle),t}function hn(e){for(var r="",t=!1,n,i=0;i<e.length;++i)if(n=e[i],t){switch(n){case"n":r+=`
`;break;default:r+=n}t=!1}else n==="\\"?t=!0:r+=n;return r}function ge(e,r,t){var n=r.label,i=e.append("g");r.labelType==="svg"?un(i,r):typeof n!="string"||r.labelType==="html"?dn(i,r):fn(i,r);var a=i.node().getBBox(),o;switch(t){case"top":o=-r.height/2;break;case"bottom":o=r.height/2-a.height;break;default:o=-a.height/2}return i.attr("transform","translate("+-a.width/2+","+o+")"),i}var oe=function(e,r){var t=r.nodes().filter(function(a){return Qe(r,a)}),n=e.selectAll("g.cluster").data(t,function(a){return a});_(n.exit(),r).style("opacity",0).remove();var i=n.enter().append("g").attr("class","cluster").attr("id",function(a){var o=r.node(a);return o.id}).style("opacity",0).each(function(a){var o=r.node(a),s=x(this);x(this).append("rect");var d=s.append("g").attr("class","label");ge(d,o,o.clusterLabelPos)});return n=n.merge(i),n=_(n,r).style("opacity",1),n.selectAll("rect").each(function(a){var o=r.node(a),s=x(this);L(s,o.style)}),n};function cn(e){oe=e}let se=function(e,r){var t=e.selectAll("g.edgeLabel").data(r.edges(),function(i){return Je(i)}).classed("update",!0);t.exit().remove(),t.enter().append("g").classed("edgeLabel",!0).style("opacity",0),t=e.selectAll("g.edgeLabel"),t.each(function(i){var a=x(this);a.select(".label").remove();var o=r.edge(i),s=ge(a,r.edge(i),0).classed("label",!0),d=s.node().getBBox();o.labelId&&s.attr("id",o.labelId),p(o,"width")||(o.width=d.width),p(o,"height")||(o.height=d.height)});var n;return t.exit?n=t.exit():n=t.selectAll(null),_(n,r).style("opacity",0).remove(),t};function ln(e){se=e}function Oe(e,r){return e.intersect(r)}var de=function(e,r,t){var n=e.selectAll("g.edgePath").data(r.edges(),function(o){return Je(o)}).classed("update",!0),i=wn(n,r);bn(n,r);var a=n.merge!==void 0?n.merge(i):n;return _(a,r).style("opacity",1),a.each(function(o){var s=x(this),d=r.edge(o);d.elem=this,d.id&&s.attr("id",d.id),Ke(s,d.class,(s.classed("update")?"update ":"")+"edgePath")}),a.selectAll("path.path").each(function(o){var s=r.edge(o);s.arrowheadId=X("arrowhead");var d=x(this).attr("marker-end",function(){return"url("+pn(location.href,s.arrowheadId)+")"}).style("fill","none");_(d,r).attr("d",function(u){return gn(r,u)}),L(d,s.style)}),a.selectAll("defs *").remove(),a.selectAll("defs").each(function(o){var s=r.edge(o),d=t[s.arrowhead];d(x(this),s.arrowheadId,s,"arrowhead")}),a};function vn(e){de=e}function pn(e,r){var t=e.split("#")[0];return t+"#"+r}function gn(e,r){var t=e.edge(r),n=e.node(r.v),i=e.node(r.w),a=t.points.slice(1,t.points.length-1);return a.unshift(Oe(n,a[0])),a.push(Oe(i,a[a.length-1])),Ze(t,a)}function Ze(e,r){var t=(ur||hr.line)().x(function(n){return n.x}).y(function(n){return n.y});return(t.curve||t.interpolate)(e.curve),t(r)}function mn(e){var r=e.getBBox(),t=e.ownerSVGElement.getScreenCTM().inverse().multiply(e.getScreenCTM()).translate(r.width/2,r.height/2);return{x:t.e,y:t.f}}function wn(e,r){var t=e.enter().append("g").attr("class","edgePath").style("opacity",0);return t.append("path").attr("class","path").attr("d",function(n){var i=r.edge(n),a=r.node(n.v).elem,o=T(i.points.length).map(function(){return mn(a)});return Ze(i,o)}),t.append("defs"),t}function bn(e,r){var t=e.exit();_(t,r).style("opacity",0).remove()}var ue=function(e,r,t){var n=r.nodes().filter(function(o){return!Qe(r,o)}),i=e.selectAll("g.node").data(n,function(o){return o}).classed("update",!0);i.exit().remove(),i.enter().append("g").attr("class","node").style("opacity",0),i=e.selectAll("g.node"),i.each(function(o){var s=r.node(o),d=x(this);Ke(d,s.class,(d.classed("update")?"update ":"")+"node"),d.select("g.label").remove();var u=d.append("g").attr("class","label"),h=ge(u,s),c=t[s.shape],l=V(h.node().getBBox(),"width","height");s.elem=this,s.id&&d.attr("id",s.id),s.labelId&&u.attr("id",s.labelId),p(s,"width")&&(l.width=s.width),p(s,"height")&&(l.height=s.height),l.width+=s.paddingLeft+s.paddingRight,l.height+=s.paddingTop+s.paddingBottom,u.attr("transform","translate("+(s.paddingLeft-s.paddingRight)/2+","+(s.paddingTop-s.paddingBottom)/2+")");var g=x(this);g.select(".label-container").remove();var v=c(g,l,s).classed("label-container",!0);L(v,s.style);var m=v.node().getBBox();s.width=m.width,s.height=m.height});var a;return i.exit?a=i.exit():a=i.selectAll(null),_(a,r).style("opacity",0).remove(),i};function yn(e){ue=e}function xn(e,r){var t=e.filter(function(){return!x(this).classed("update")});function n(i){var a=r.node(i);return"translate("+a.x+","+a.y+")"}t.attr("transform",n),_(e,r).style("opacity",1).attr("transform",n),_(t.selectAll("rect"),r).attr("width",function(i){return r.node(i).width}).attr("height",function(i){return r.node(i).height}).attr("x",function(i){var a=r.node(i);return-a.width/2}).attr("y",function(i){var a=r.node(i);return-a.height/2})}function _n(e,r){var t=e.filter(function(){return!x(this).classed("update")});function n(i){var a=r.edge(i);return p(a,"x")?"translate("+a.x+","+a.y+")":""}t.attr("transform",n),_(e,r).style("opacity",1).attr("transform",n)}function En(e,r){var t=e.filter(function(){return!x(this).classed("update")});function n(i){var a=r.node(i);return"translate("+a.x+","+a.y+")"}t.attr("transform",n),_(e,r).style("opacity",1).attr("transform",n)}function er(e,r,t,n){var i=e.x,a=e.y,o=i-n.x,s=a-n.y,d=Math.sqrt(r*r*s*s+t*t*o*o),u=Math.abs(r*t*o/d);n.x<i&&(u=-u);var h=Math.abs(r*t*s/d);return n.y<a&&(h=-h),{x:i+u,y:a+h}}function kn(e,r,t){return er(e,r,r,t)}function Nn(e,r,t,n){var i,a,o,s,d,u,h,c,l,g,v,m,y,C,B;if(i=r.y-e.y,o=e.x-r.x,d=r.x*e.y-e.x*r.y,l=i*t.x+o*t.y+d,g=i*n.x+o*n.y+d,!(l!==0&&g!==0&&Be(l,g))&&(a=n.y-t.y,s=t.x-n.x,u=n.x*t.y-t.x*n.y,h=a*e.x+s*e.y+u,c=a*r.x+s*r.y+u,!(h!==0&&c!==0&&Be(h,c))&&(v=i*s-a*o,v!==0)))return m=Math.abs(v/2),y=o*u-s*d,C=y<0?(y-m)/v:(y+m)/v,y=a*d-i*u,B=y<0?(y-m)/v:(y+m)/v,{x:C,y:B}}function Be(e,r){return e*r>0}function Ln(e,r,t){var n=e.x,i=e.y,a=[],o=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;r.forEach(function(v){o=Math.min(o,v.x),s=Math.min(s,v.y)});for(var d=n-e.width/2-o,u=i-e.height/2-s,h=0;h<r.length;h++){var c=r[h],l=r[h<r.length-1?h+1:0],g=Nn(e,t,{x:d+c.x,y:u+c.y},{x:d+l.x,y:u+l.y});g&&a.push(g)}return a.length?(a.length>1&&a.sort(function(v,m){var y=v.x-t.x,C=v.y-t.y,B=Math.sqrt(y*y+C*C),me=m.x-t.x,we=m.y-t.y,be=Math.sqrt(me*me+we*we);return B<be?-1:B===be?0:1}),a[0]):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",e),e)}function Cn(e,r){var t=e.x,n=e.y,i=r.x-t,a=r.y-n,o=e.width/2,s=e.height/2,d,u;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),d=a===0?0:s*i/a,u=s):(i<0&&(o=-o),d=o,u=i===0?0:o*a/i),{x:t+d,y:n+u}}var fe={rect:Tn,ellipse:Sn,circle:Rn,diamond:Mn};function In(e){fe=e}function Tn(e,r,t){var n=e.insert("rect",":first-child").attr("rx",t.rx).attr("ry",t.ry).attr("x",-r.width/2).attr("y",-r.height/2).attr("width",r.width).attr("height",r.height);return t.intersect=function(i){return Cn(t,i)},n}function Sn(e,r,t){var n=r.width/2,i=r.height/2,a=e.insert("ellipse",":first-child").attr("x",-r.width/2).attr("y",-r.height/2).attr("rx",n).attr("ry",i);return t.intersect=function(o){return er(t,n,i,o)},a}function Rn(e,r,t){var n=Math.max(r.width,r.height)/2,i=e.insert("circle",":first-child").attr("x",-r.width/2).attr("y",-r.height/2).attr("r",n);return t.intersect=function(a){return kn(t,n,a)},i}function Mn(e,r,t){var n=r.width*Math.SQRT2/2,i=r.height*Math.SQRT2/2,a=[{x:0,y:-i},{x:-n,y:0},{x:0,y:i},{x:n,y:0}],o=e.insert("polygon",":first-child").attr("points",a.map(function(s){return s.x+","+s.y}).join(" "));return t.intersect=function(s){return Ln(t,a,s)},o}function Un(){var e=function(r,t){Bn(t);var n=A(r,"output"),i=A(n,"clusters"),a=A(n,"edgePaths"),o=se(A(n,"edgeLabels"),t),s=ue(A(n,"nodes"),t,fe);Mt(t),En(s,t),_n(o,t),de(a,t,ae);var d=oe(i,t);xn(d,t),An(t)};return e.createNodes=function(r){return arguments.length?(yn(r),e):ue},e.createClusters=function(r){return arguments.length?(cn(r),e):oe},e.createEdgeLabels=function(r){return arguments.length?(ln(r),e):se},e.createEdgePaths=function(r){return arguments.length?(vn(r),e):de},e.shapes=function(r){return arguments.length?(In(r),e):fe},e.arrows=function(r){return arguments.length?(nn(r),e):ae},e}var Pn={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},On={arrowhead:"normal",curve:fr};function Bn(e){e.nodes().forEach(function(r){var t=e.node(r);!p(t,"label")&&!e.children(r).length&&(t.label=r),p(t,"paddingX")&&P(t,{paddingLeft:t.paddingX,paddingRight:t.paddingX}),p(t,"paddingY")&&P(t,{paddingTop:t.paddingY,paddingBottom:t.paddingY}),p(t,"padding")&&P(t,{paddingLeft:t.padding,paddingRight:t.padding,paddingTop:t.padding,paddingBottom:t.padding}),P(t,Pn),f(["paddingLeft","paddingRight","paddingTop","paddingBottom"],function(n){t[n]=Number(t[n])}),p(t,"width")&&(t._prevWidth=t.width),p(t,"height")&&(t._prevHeight=t.height)}),e.edges().forEach(function(r){var t=e.edge(r);p(t,"label")||(t.label=""),P(t,On)})}function An(e){f(e.nodes(),function(r){var t=e.node(r);p(t,"_prevWidth")?t.width=t._prevWidth:delete t.width,p(t,"_prevHeight")?t.height=t._prevHeight:delete t.height,delete t._prevWidth,delete t._prevHeight})}function A(e,r){var t=e.select("g."+r);return t.empty()&&(t=e.append("g").attr("class",r)),t}function Xn(e){var r={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:Dn(e),edges:Fn(e)};return w(e.graph())||(r.value=dr(e.graph())),r}function Dn(e){return b(e.nodes(),function(r){var t=e.node(r),n=e.parent(r),i={v:r};return w(t)||(i.value=t),w(n)||(i.parent=n),i})}function Fn(e){return b(e.edges(),function(r){var t=e.edge(r),n={v:r.v,w:r.w};return w(r.name)||(n.name=r.name),w(t)||(n.value=t),n})}export{E as G,dn as a,L as b,Cn as c,Ln as i,Mt as l,Un as r,Xn as w};
