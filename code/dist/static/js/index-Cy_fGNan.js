import{v as S,w as y}from"./@vue_runtime-dom@3.5.12-iSYHT88p.js";import{$ as U,a0 as A,u as F,P as K}from"./@element-plus_icons-vue@2.3.1_vue@3.5.12_typescript@5.5.4_-DwlSpvcG.js";import{i as L}from"./comm-DyJRlPK0.js";import{q as j}from"./index-CyAmoSeV.js";import{u as R}from"./index-4ocppgba.js";import"./@wangeditor_plugin-link-card@1.0.0_@wangeditor_editor@5.1.23_snabbdom@3.6.2-D_kdJ7Fs.js";import"./@wangeditor_editor@5.1.23-BNs7_II4.js";import{g as G,f as H,a as J}from"./index-i6JPj4J-.js";import{a as Q}from"./@vueuse_core@11.1.0_vue@3.5.12_typescript@5.5.4_-BKaerpSy.js";import"./store@2.0.12-RoMfFez2.js";import{d as C,a as o,c as l,f as r,K as v,O as w,i as p,L as k,F as V,n as W,_ as g,a0 as X,M as T,b as P,w as Y,o as Z,a6 as ee}from"./@vue_runtime-core@3.5.12-Bt7zQ28n.js";import{n as E,v as c}from"./@vue_reactivity@3.5.12-vtUNgENk.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as te}from"./element-plus@2.8.4_vue@3.5.12_typescript@5.5.4_-C7CHjwzj.js";import{O as h,p as N,q as oe}from"./@vue_shared@3.5.12-UFe9jxSY.js";import"./@braintree_sanitize-url@6.0.4-BB1FEM6a.js";import"./vue@3.5.12_typescript@5.5.4-kKmasoJt.js";import"./lodash-es@4.17.21-D6PnhKvy.js";import"./mitt@3.0.1-C1z4c41a.js";import"./axios@1.7.7-CCb-kr4I.js";import"./nprogress@0.2.0-B8S133N7.js";import"./pinia@2.2.4_typescript@5.5.4_vue@3.5.12_typescript@5.5.4_-CVf9nHlw.js";import"./vue-demi@0.14.10_vue@3.5.12_typescript@5.5.4_-DvPnGcuI.js";import"./@bytemd_plugin-math@1.21.0_bytemd@1.21.0-Dc_JUVYX.js";import"./remark-math@5.1.1-C8vps_rM.js";import"./micromark-extension-math@2.1.2-StTlgfH1.js";import"./micromark-factory-space@1.1.0-C57A7NS2.js";import"./micromark-util-character@1.2.0-D-NaLusr.js";import"./katex@0.16.11-CvgdMzdh.js";import"./mdast-util-math@2.0.2-Boy2OOKg.js";import"./longest-streak@3.1.0-BHNUWYJP.js";import"./mdast-util-to-markdown@1.5.0-D9VzXa1u.js";import"./micromark-util-decode-string@1.1.0-CdHYbWAu.js";import"./decode-named-character-reference@1.0.2-C3-224fz.js";import"./micromark-util-decode-numeric-character-reference@1.1.0-DRnCnno4.js";import"./vue-router@4.4.5_vue@3.5.12_typescript@5.5.4_-DGEeQixy.js";import"./mockjs@1.1.0-hXCvQ4kl.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.12_echarts@5.5.1_vue@3.5.12_typescript@5.5.4_-tmE62Ovn.js";import"./echarts@5.5.1-D8FyPvXx.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.0-CH1asNwC.js";import"./@vueuse_shared@9.13.0_vue@3.5.12_typescript@5.5.4_-u9BR5ga7.js";import"./@vueuse_core@9.13.0_vue@3.5.12_typescript@5.5.4_-B3H9WZsa.js";import"./@sxzz_popperjs-es@2.11.7-DkudPAZk.js";import"./@ctrl_tinycolor@3.6.1--gef7wIN.js";import"./dayjs@1.11.13-DXimfR00.js";import"./async-validator@4.2.5-DbzRl2Zc.js";import"./memoize-one@6.0.0-DQFWdy6B.js";import"./normalize-wheel-es@1.2.0-D2sExr9L.js";import"./@floating-ui_dom@1.6.11-Db5K7U0i.js";import"./@floating-ui_core@1.6.8-B67JZAQv.js";import"./@floating-ui_utils@0.2.8-BSxVqCX2.js";import"./lodash-unified@1.0.3_@types_lodash-es@4.17.12_lodash-es@4.17.21_lodash@4.17.21-D8rsWRp7.js";import"./@vueuse_shared@11.1.0_vue@3.5.12_typescript@5.5.4_-DXriuop5.js";const ie={class:"viewer-image"},se={class:"viewer-doc"},ae=["src"],le=C({name:"file-viewer"}),re=C({...le,setup(e,{expose:x}){const{refs:i,setRefs:$}=R(),d=E({visible:!1,url:""}),a=E({visible:!1,loading:!1,url:""});function M(n){if(n!=null&&n.type){const m=n.url||"",f=G(m);if(f=="image")return d.visible=!0,d.url=m,!0;if(["word","excel","ppt","pdf"].includes(f))return a.visible=!0,a.loading=!0,a.url=`https://view.officeapps.live.com/op/view.aspx?src=${decodeURIComponent(m)}`,W(()=>{i.docIframe.onload=()=>{a.loading=!1}}),!0;window.open(n.url)}}function _(){d.visible=!1}return x({open:M}),(n,m)=>{const f=g("el-image-viewer"),B=g("cl-dialog"),u=X("loading");return o(),l(V,null,[r("div",ie,[d.visible?(o(),v(f,{key:0,"url-list":[d.url],infinite:"",teleported:"",onClose:_},null,8,["url-list"])):w("",!0)]),p(B,{modelValue:a.visible,"onUpdate:modelValue":m[0]||(m[0]=t=>a.visible=t),title:"文档预览",height:"70vh",width:"80%",scrollbar:!1},{default:k(()=>[T((o(),l("div",se,[r("iframe",{ref:c($)("docIframe"),src:a.url},null,8,ae)])),[[u,a.loading]])]),_:1},8,["modelValue"])],64)}}}),ne=q(re,[["__scopeId","data-v-ccd57659"]]),me={class:"cl-upload-item__wrap"},ce=["src"],de={class:"cl-upload-item__icon"},ue={class:"cl-upload-item__name"},pe=["src"],fe={class:"cl-upload-item__progress-bar"},ve={class:"cl-upload-item__progress-value"},_e={key:5,class:"cl-upload-item__actions"},ge=C({name:"cl-upload-item"}),ye=C({...ge,props:{item:{type:Object,required:!0},list:{type:Array,default:()=>[]},disabled:Boolean,deletable:Boolean,showTag:{type:Boolean,default:!0}},emits:["remove"],setup(e,{emit:x}){const i=e,$=x,{refs:d,setRefs:a}=R(),{copy:M}=Q(),_=P(()=>i.item.url||""),n=P(()=>({color:J(i.item.type).color,name:j(i.item.name||_.value)}));function m(){$("remove",i.item)}function f(){d.viewer.open(i.item)}function B(t){L.ContextMenu.open(t,{hover:{target:"cl-upload-item__wrap"},list:[{label:"预览",callback(s){f(),s()}},{label:"复制链接",callback(s){i.item.url&&(M(i.item.url),te.success("复制成功")),s()}},{label:"删除",callback(s){m(),s()}}]})}const u=E({isMedia:["video","audio"].includes(i.item.type),play(){i.list.forEach(t=>{t.isPlay=t.uid?i.item.uid==t.uid:i.item.id==t.id})},pause(){i.item.isPlay=!1},create(){if(!u.isMedia)return!1;let t;Y(()=>i.item.isPlay,s=>{t||(t=d[i.item.type],t==null||t.addEventListener("ended",()=>{u.pause()})),s?t==null||t.play():t==null||t.pause()})}});return Z(()=>{u.create()}),(t,s)=>{const z=g("el-image"),D=g("cl-svg"),O=g("el-progress"),b=g("el-icon");return o(),l("div",me,[(o(),v(ee,null,[r("div",{class:N(["cl-upload-item",[{"is-play":e.item.isPlay}]]),onContextmenu:y(B,["stop","prevent"])},[e.item.type==="image"&&!e.item.error?(o(),v(z,{key:0,class:"cl-upload-item__image-cover",fit:"contain",src:e.item.preload||_.value,onError:s[0]||(s[0]=I=>e.item.error="加载失败")},null,8,["src"])):e.item.type==="video"?(o(),l("video",{ref:c(a)("video"),key:e.item.url,src:e.item.url},null,8,ce)):(o(),l(V,{key:2},[r("div",de,[p(D,{name:e.item.type},null,8,["name"])]),r("div",ue,[r("span",null,h(c(H)(e.item.name||_.value)),1),T(r("span",{class:"error"},h(e.item.error),513),[[S,e.item.error]])])],64)),e.item.type==="audio"?(o(),l("audio",{key:3,ref:c(a)("audio"),controls:""},[(o(),l("source",{key:e.item.url,src:e.item.url,type:"audio/mpeg"},null,8,pe))],512)):w("",!0),r("div",{class:N(["cl-upload-item__progress",{"is-show":e.item.progress>=0&&e.item.progress<100,"is-hide":e.item.progress==100}])},[r("div",fe,[p(O,{percentage:e.item.progress,"show-text":!1},null,8,["percentage"])]),r("span",ve,h(e.item.progress),1)],2),e.showTag?(o(),l("span",{key:4,class:"cl-upload-item__tag",style:oe({backgroundColor:n.value.color})},h(n.value.name),5)):w("",!0),_.value?(o(),l("div",_e,[u.isMedia?(o(),l(V,{key:0},[e.item.isPlay?(o(),v(b,{key:0,class:"action-pause",onClick:s[1]||(s[1]=y(I=>u.pause(),["stop"]))},{default:k(()=>[p(c(U))]),_:1})):(o(),v(b,{key:1,class:"action-play",onClick:s[2]||(s[2]=y(I=>u.play(),["stop"]))},{default:k(()=>[p(c(A))]),_:1}))],64)):(o(),v(b,{key:1,class:"action-preview",onClick:y(f,["stop"])},{default:k(()=>[p(c(F))]),_:1})),!e.disabled||e.deletable?(o(),v(b,{key:2,class:"action-delete",onClick:y(m,["stop"])},{default:k(()=>[p(c(K))]),_:1})):w("",!0)])):w("",!0)],34)],1024)),p(ne,{ref:c(a)("viewer")},null,512)])}}}),wt=q(ye,[["__scopeId","data-v-84470e1a"]]);export{wt as default};
