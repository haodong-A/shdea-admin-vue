import"./index-Ghdj5350.js";import"./store@2.0.12-RoMfFez2.js";import{u as Q}from"./index-BEUtcyhA.js";import"./@wangeditor_plugin-link-card@1.0.0_@wangeditor_editor@5.1.23_snabbdom@3.6.2-D_kdJ7Fs.js";import"./@wangeditor_editor@5.1.23-BNs7_II4.js";import{Y as Z,B as ee}from"./@element-plus_icons-vue@2.3.1_vue@3.5.12_typescript@5.5.4_-DwlSpvcG.js";import{m as te}from"./marked@14.1.3-CupyhQa1.js";import{i as oe}from"./comm-DyJRlPK0.js";import{a as c,b as x}from"./element-plus@2.8.4_vue@3.5.12_typescript@5.5.4_-C7CHjwzj.js";import{B as ne}from"./lodash-es@4.17.21-D6PnhKvy.js";import{d as P,n as se,R as ae,_ as s,a as C,K as S,L as a,f as l,i as o,c as le,X as re,P as h,F as ie}from"./@vue_runtime-core@3.5.12-Bt7zQ28n.js";import{n as ce,r as E,v as k}from"./@vue_reactivity@3.5.12-vtUNgENk.js";import{O as m}from"./@vue_shared@3.5.12-UFe9jxSY.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./@vue_runtime-dom@3.5.12-iSYHT88p.js";import"./@vueuse_core@11.1.0_vue@3.5.12_typescript@5.5.4_-BKaerpSy.js";import"./@vueuse_shared@11.1.0_vue@3.5.12_typescript@5.5.4_-DXriuop5.js";import"./mitt@3.0.1-C1z4c41a.js";import"./axios@1.7.7-CCb-kr4I.js";import"./nprogress@0.2.0-B8S133N7.js";import"./@braintree_sanitize-url@6.0.4-BB1FEM6a.js";import"./pinia@2.2.4_typescript@5.5.4_vue@3.5.12_typescript@5.5.4_-CVf9nHlw.js";import"./vue-demi@0.14.10_vue@3.5.12_typescript@5.5.4_-DvPnGcuI.js";import"./vue@3.5.12_typescript@5.5.4-kKmasoJt.js";import"./@bytemd_plugin-math@1.21.0_bytemd@1.21.0-Dc_JUVYX.js";import"./remark-math@5.1.1-C8vps_rM.js";import"./micromark-extension-math@2.1.2-StTlgfH1.js";import"./micromark-factory-space@1.1.0-C57A7NS2.js";import"./micromark-util-character@1.2.0-D-NaLusr.js";import"./katex@0.16.11-CvgdMzdh.js";import"./mdast-util-math@2.0.2-Boy2OOKg.js";import"./longest-streak@3.1.0-BHNUWYJP.js";import"./mdast-util-to-markdown@1.5.0-D9VzXa1u.js";import"./micromark-util-decode-string@1.1.0-CdHYbWAu.js";import"./decode-named-character-reference@1.0.2-C3-224fz.js";import"./micromark-util-decode-numeric-character-reference@1.1.0-DRnCnno4.js";import"./vue-router@4.4.5_vue@3.5.12_typescript@5.5.4_-DGEeQixy.js";import"./mockjs@1.1.0-hXCvQ4kl.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.12_echarts@5.5.1_vue@3.5.12_typescript@5.5.4_-tmE62Ovn.js";import"./echarts@5.5.1-D8FyPvXx.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.0-CH1asNwC.js";import"./@vueuse_shared@9.13.0_vue@3.5.12_typescript@5.5.4_-u9BR5ga7.js";import"./@vueuse_core@9.13.0_vue@3.5.12_typescript@5.5.4_-B3H9WZsa.js";import"./@sxzz_popperjs-es@2.11.7-DkudPAZk.js";import"./@ctrl_tinycolor@3.6.1--gef7wIN.js";import"./dayjs@1.11.13-DXimfR00.js";import"./async-validator@4.2.5-DbzRl2Zc.js";import"./memoize-one@6.0.0-DQFWdy6B.js";import"./normalize-wheel-es@1.2.0-D2sExr9L.js";import"./@floating-ui_dom@1.6.11-Db5K7U0i.js";import"./@floating-ui_core@1.6.8-B67JZAQv.js";import"./@floating-ui_utils@0.2.8-BSxVqCX2.js";import"./lodash-unified@1.0.3_@types_lodash-es@4.17.12_lodash-es@4.17.21_lodash@4.17.21-D8rsWRp7.js";const me={class:"plugins"},ue={class:"scope"},de={class:"c"},_e=["src"],fe={class:"det"},ge={class:"tag"},he={class:"title"},ve={class:"desc"},we={class:"author"},be={class:"f"},xe={class:"scope is-add"},Ce={class:"info-header"},ke=P({name:"helper-plugins-serve"}),ye=P({...ke,setup(Te){const{service:u,refs:y,setRefs:T}=Q(),B=oe.useForm(),v=ce({active:"installed",onChange(e){e=="shop"&&se(()=>{v.active="installed",window.open("https://cool-js.com/plugin")})}}),b=E([]),d=E();function V(){u.plugin.info.page({page:1,size:100}).then(e=>{b.value=e.list})}function U(e){var t;(t=B.value)==null||t.open({title:"设置",props:{labelWidth:"60px"},form:{...e},items:[{label:"参数",prop:"config",value:"{}",component:{name:"cl-editor",props:{name:"cl-editor-monaco",ref:T("editor")}}},{label:" ",flex:!1,component:{name:"slot-upload"}},{label:"状态",prop:"status",component:{name:"cl-switch"}}],on:{submit(r,{done:p,close:i}){try{const _=JSON.parse(r.config);u.plugin.info.update({config:_,id:r.id,status:r.status}).then(()=>{c.success("修改成功"),ne(e,r),i()}).catch(w=>{c.error(w.message),p()})}catch{c.error("参数格式错误，请检查"),p()}}}})}async function z(e){d.value=e,y.editorPreview.open(await te.parse(e.readme))}function L(e,t){x.confirm(`确定要卸载插件【${e.name}】吗？`,"提示",{type:"warning"}).then(()=>{u.plugin.info.delete({ids:[e.id]}).then(()=>{b.value.splice(t,1),c.success("卸载成功")}).catch(r=>{c.error(r.message)})}).catch(()=>null)}function O(e){var t;y.editor.appendContent((t=e[0])==null?void 0:t.url)}function j(e){u.plugin.info.update({id:e.id,status:e.status}).then(()=>{c.success(e.status?"开启成功":"关闭成功")}).catch(t=>{c.error(t.message)})}function D(e){function t(r){const p=new FormData;p.append("files",e),p.append("force",r),u.plugin.info.request({url:"/install",method:"POST",data:p,headers:{"Content-Type":"multipart/form-data"}}).then(i=>{i?x.confirm(i.message,"提示",{type:"warning",confirmButtonText:"继续"}).then(()=>{t("true")}).catch(()=>null):(c.success("插件安装成功"),V())}).catch(i=>{c.error(i.message)})}return t("false"),!1}function M(e){e.preventDefault()}function R(e){if(e.preventDefault(),e.dataTransfer){const t=e.dataTransfer.files[0];x.confirm("检测到插件，是否安装","提示",{type:"warning",confirmButtonText:"安装"}).then(()=>{D(t)}).catch(()=>null)}}return ae(()=>{V()}),(e,t)=>{const r=s("el-tab-pane"),p=s("el-tabs"),i=s("el-icon"),_=s("el-tag"),w=s("el-button"),q=s("cl-flex1"),A=s("cl-switch"),F=s("el-col"),I=s("cl-upload"),J=s("el-row"),K=s("cl-editor-preview"),W=s("cl-upload-space"),X=s("el-text"),Y=s("cl-row"),G=s("cl-form"),H=s("el-scrollbar");return C(),S(H,{class:"plugins__wrapper",onDragover:M,onDrop:R},{default:a(()=>{var $,N;return[l("div",me,[o(p,{modelValue:v.active,"onUpdate:modelValue":t[0]||(t[0]=n=>v.active=n),type:"card",onTabChange:v.onChange},{default:a(()=>[o(r,{label:"已安装插件",name:"installed"}),o(r,{label:"插件市场",name:"shop"})]),_:1},8,["modelValue","onTabChange"]),o(J,{gutter:10},{default:a(()=>[(C(!0),le(ie,null,re(b.value,(n,f)=>(C(),S(F,{key:f,xs:24,sm:12,md:8,lg:6},{default:a(()=>[l("div",ue,[l("div",de,[o(i,{class:"set",onClick:g=>U(n)},{default:a(()=>[o(k(Z))]),_:2},1032,["onClick"]),l("img",{class:"logo",src:"data:image/jpg;base64,"+n.logo},null,8,_e),l("div",fe,[l("div",ge,[o(_,{size:"small",effect:"dark"},{default:a(()=>[h(m(n.keyName),1)]),_:2},1024),o(_,{size:"small",effect:"dark",type:"success"},{default:a(()=>[h("v"+m(n.version),1)]),_:2},1024)]),l("p",he,m(n.name||"未知"),1),l("p",ve,m(n.description||"暂无描述"),1),l("div",we,[l("span",null,m(n.author)+"：",1),l("span",null,m(n.updateTime),1)])])]),l("div",be,[o(w,{round:"",onClick:g=>z(n)},{default:a(()=>t[1]||(t[1]=[h("详情")])),_:2},1032,["onClick"]),o(w,{type:"danger",round:"",onClick:g=>L(n,f)},{default:a(()=>t[2]||(t[2]=[h("卸载")])),_:2},1032,["onClick"]),o(q),o(A,{modelValue:n.status,"onUpdate:modelValue":g=>n.status=g,onChange:g=>j(n)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])]),_:2},1024))),128)),o(F,{xs:24,sm:12,md:8,lg:6},{default:a(()=>[o(I,{"before-upload":D,accept:".cool"},{default:a(()=>[l("div",xe,[o(i,null,{default:a(()=>[o(k(ee))]),_:1})])]),_:1})]),_:1})]),_:1}),o(K,{ref:k(T)("editorPreview"),name:"wang","show-btn":!1,title:`${($=d.value)==null?void 0:$.name} v${(N=d.value)==null?void 0:N.version} 说明文档`},{prepend:a(()=>{var n,f;return[l("div",Ce,[l("span",null,"作者："+m((n=d.value)==null?void 0:n.author),1),l("span",null,"更新时间："+m((f=d.value)==null?void 0:f.updateTime),1)])]}),_:1},8,["title"]),o(G,{ref_key:"Form",ref:B},{"slot-upload":a(()=>[o(Y,null,{default:a(()=>[o(W,{"show-list":!1,multiple:!1,text:"选择文件",onConfirm:O}),o(X,{type:"warning",style:{marginLeft:"10px"}},{default:a(()=>t[3]||(t[3]=[h("选择后会在光标后插入文件链接")])),_:1})]),_:1})]),_:1},512)])]}),_:1})}}}),Bt=pe(ye,[["__scopeId","data-v-15ccacf7"]]);export{Bt as default};
