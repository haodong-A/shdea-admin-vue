import{b as et}from"./@vue_runtime-dom@3.5.12-iSYHT88p.js";import{j as ot,m as W,k as B,s as x,l as lt}from"./index-CyAmoSeV.js";import{u as nt}from"./index-4ocppgba.js";import"./@wangeditor_plugin-link-card@1.0.0_@wangeditor_editor@5.1.23_snabbdom@3.6.2-D_kdJ7Fs.js";import"./@wangeditor_editor@5.1.23-BNs7_II4.js";import{D as at,W as st,l as M,F as D,U as it,X as rt,T as dt}from"./@element-plus_icons-vue@2.3.1_vue@3.5.12_typescript@5.5.4_-DwlSpvcG.js";import{u as ct,a as ut}from"./menu-CKmUdZXU.js";import{i as mt}from"./comm-DyJRlPK0.js";import{d as pt}from"./dayjs@1.11.13-DXimfR00.js";import{a as ft}from"./@vueuse_core@11.1.0_vue@3.5.12_typescript@5.5.4_-BKaerpSy.js";import{a as $,c as vt,b as _t}from"./element-plus@2.8.4_vue@3.5.12_typescript@5.5.4_-C7CHjwzj.js";import{W as P,a as A}from"./lodash-es@4.17.21-D6PnhKvy.js";import{d as K,n as gt,b as yt,o as kt,a as _,c as g,f as n,i as l,L as d,P as C,O as b,K as L,F as T,X as U,_ as w}from"./@vue_runtime-core@3.5.12-Bt7zQ28n.js";import{n as E,v as f}from"./@vue_reactivity@3.5.12-vtUNgENk.js";import{O as I,p as J}from"./@vue_shared@3.5.12-UFe9jxSY.js";import{_ as Ct}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./store@2.0.12-RoMfFez2.js";import"./@braintree_sanitize-url@6.0.4-BB1FEM6a.js";import"./mitt@3.0.1-C1z4c41a.js";import"./axios@1.7.7-CCb-kr4I.js";import"./nprogress@0.2.0-B8S133N7.js";import"./pinia@2.2.4_typescript@5.5.4_vue@3.5.12_typescript@5.5.4_-CVf9nHlw.js";import"./vue-demi@0.14.10_vue@3.5.12_typescript@5.5.4_-DvPnGcuI.js";import"./vue@3.5.12_typescript@5.5.4-kKmasoJt.js";import"./@bytemd_plugin-math@1.21.0_bytemd@1.21.0-Dc_JUVYX.js";import"./remark-math@5.1.1-C8vps_rM.js";import"./micromark-extension-math@2.1.2-StTlgfH1.js";import"./micromark-factory-space@1.1.0-C57A7NS2.js";import"./micromark-util-character@1.2.0-D-NaLusr.js";import"./katex@0.16.11-CvgdMzdh.js";import"./mdast-util-math@2.0.2-Boy2OOKg.js";import"./longest-streak@3.1.0-BHNUWYJP.js";import"./mdast-util-to-markdown@1.5.0-D9VzXa1u.js";import"./micromark-util-decode-string@1.1.0-CdHYbWAu.js";import"./decode-named-character-reference@1.0.2-C3-224fz.js";import"./micromark-util-decode-numeric-character-reference@1.1.0-DRnCnno4.js";import"./vue-router@4.4.5_vue@3.5.12_typescript@5.5.4_-DGEeQixy.js";import"./mockjs@1.1.0-hXCvQ4kl.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.12_echarts@5.5.1_vue@3.5.12_typescript@5.5.4_-tmE62Ovn.js";import"./echarts@5.5.1-D8FyPvXx.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.0-CH1asNwC.js";import"./@vueuse_shared@9.13.0_vue@3.5.12_typescript@5.5.4_-u9BR5ga7.js";import"./@vueuse_core@9.13.0_vue@3.5.12_typescript@5.5.4_-B3H9WZsa.js";import"./@sxzz_popperjs-es@2.11.7-DkudPAZk.js";import"./@ctrl_tinycolor@3.6.1--gef7wIN.js";import"./async-validator@4.2.5-DbzRl2Zc.js";import"./memoize-one@6.0.0-DQFWdy6B.js";import"./normalize-wheel-es@1.2.0-D2sExr9L.js";import"./@floating-ui_dom@1.6.11-Db5K7U0i.js";import"./@floating-ui_core@1.6.8-B67JZAQv.js";import"./@floating-ui_utils@0.2.8-BSxVqCX2.js";import"./lodash-unified@1.0.3_@types_lodash-es@4.17.12_lodash-es@4.17.21_lodash@4.17.21-D8rsWRp7.js";import"./@vueuse_shared@11.1.0_vue@3.5.12_typescript@5.5.4_-DXriuop5.js";const wt={class:"ai-code"},ht={class:"head"},xt={class:"desc"},bt={key:0,class:"start"},Vt={key:1,class:"enter"},Et={class:"editor"},Nt={class:"topbar"},Ft={class:"dots"},$t={class:"content"},Lt={class:"row"},It={class:"label"},Ot={class:"row module"},St={class:"label"},qt={class:"module-list"},jt=["onClick"],Dt={class:"row"},Tt={class:"label"},Ut={key:0,class:"row"},Jt={class:"label"},Wt={class:"btns"},Bt={key:2,class:"coding"},Mt={class:"editor"},Pt={class:"topbar"},At={class:"dots"},Kt={class:"content"},Rt={class:"tabs"},zt=["onClick"],Ht={key:0,class:"op"},Xt={class:"code"},Gt={class:"console"},Qt={class:"date"},Yt={class:"text"},Zt=K({name:"helper-ai-code"}),te=K({...Zt,setup(ee){const{service:oe,refs:N,setRefs:O,router:R}=nt(),z=ut(),k=ct(),H=mt.useForm(),{copy:X}=ft(),c=E({entity:"",module:"",other:"",column:""}),i=E({loading:!1,value:"start",list:["start","enter","form","coding"],async next(){if(i.loading)return!1;i.loading=!0;let o=i.value;const e=i.list.indexOf(o);switch(e<i.list.length-1&&(o=i.list[e+1]),o){case"enter":setTimeout(()=>{N.inputEntity.focus()},300);break;case"form":if(!c.entity)return i.loading=!1,!1;r.set(["正在做初步分析，请稍等..."]),await t.getColumns();break}i.loading=!1,i.value=o,r.change()},prev(){const o=i.list.indexOf(i.value);o>0&&(i.value=i.list[o-1])}}),y=E({value:"Node",get(){y.value=ot.serviceLang,t.active=y.value.toLocaleLowerCase()+"-entity"},get tpl(){return{Node:"typescript",Java:"java",Go:"go",Python:"python"}[y.value]}}),t=E({active:"",list:[],lock:{},data:{router:"",prefix:"",fileName:"",columns:[],fieldEq:[],keyWordLikeFields:[],api:[{path:"/add",summary:"新增"},{path:"/info",summary:"单个信息"},{path:"/update",summary:"修改"},{path:"/delete",summary:"删除"},{path:"/page",summary:"分页查询"},{path:"/list",summary:"列表查询"}]},logs:[],loading:!1,req:null,async getColumns(){return k.invokeFlow("comm-column",{name:c.entity,modules:W.dirs.join("、")}).then(o=>{c.column=o.columns,c.module=o.module})},clear(){t.list=[],t.logs=[],t.loading=!1},tips(o){t.logs.push({date:pt().format("HH:mm:ss"),text:o}),gt(()=>{var e,a;(a=(e=N["console.scrollbar"])==null?void 0:e.wrapRef)==null||a.scrollTo({top:Math.random()+1e4,behavior:"smooth"})})},async createNode(){const o=await t.setContent("Entity 实体","node-entity");t.tips("Entity 开始解析");const e=await k.invokeFlow("comm-parse-entity",{entity:o,module:c.module});t.tips(`Entity 解析成功，${JSON.stringify(e)}`),t.data.router=e.path.replace("/admin",""),t.data.prefix=e.path,t.data.fileName=e.fileName,t.parseColumn();const a=await t.setContent("Service 服务","node-service",{...e,entity:o});t.tips("Service 开始解析");const m=await k.invokeFlow("comm-parse-service",{service:a});t.tips(`Service 解析成功，${JSON.stringify(m)}`);const u=await t.setContent("Controller 控制器","node-controller",{...m,...e,service:a,entity:o});t.tips("Controller 开始解析");const p=await k.invokeFlow("comm-parse-controller",{entity:o,controller:u});t.tips(`Controller 解析成功，${JSON.stringify(p)}`),t.data.fieldEq=p.fieldEq,t.data.keyWordLikeFields=p.keyWordLikeFields},async createJava(){const o=await t.setContent("Entity 实体","java-entity");t.tips("Entity 开始解析");const e=await k.invokeFlow("comm-parse-entity",{entity:o,module:c.module});t.tips(`Entity 解析成功，${JSON.stringify(e)}`),t.data.router=e.path.replace("/admin",""),t.data.prefix=e.path,t.data.fileName=e.fileName,t.parseColumn(),await t.setContent("Mapper 映射","java-mapper",{...e,entity:o});const a=await t.setContent("Service 接口类","java-service",{...e,entity:o}),m=await t.setContent("Service 实现类","java-service-impl",{...e,entity:o,service:a}),u=await k.invokeFlow("comm-parse-service",{service:m});t.tips(`Service 解析成功，${JSON.stringify(u)}`);const p=await t.setContent("Controller 控制器","java-controller",{...u,...e,service:m,entity:o});t.tips("Controller 开始解析");const v=await k.invokeFlow("comm-parse-controller",{controller:p});t.tips(`Controller 解析成功，${JSON.stringify(v)}`),t.data.fieldEq=v.fieldEq,t.data.keyWordLikeFields=v.keyWordLikeFields},async create(o){if(!c.entity)return $.warning("请填写实体名称");if(!c.module)return $.warning("请填写模块");if(!c.column)return $.warning("请填写字段");o&&(t.clear(),i.next()),t.loading=!0,t.req=null,t.tips("AI 开始编码"),await B(300),await t[`create${y.value}`](),await t.createVue(),t.tips("编码完成"),t.loading=!1},async parseColumn(){const o=k.invokeFlow("comm-parse-entity-column",{entity:t.getContent(`${y.value}-entity`)}),e=k.invokeFlow("comm-parse-column",{entity:t.getContent(`${y.value}-entity`)});t.req=Promise.all([o,e]).then(a=>{var m;(m=a[0])!=null&&m.columns&&(t.data.columns=a[0].columns.map(u=>{var p;return(p=a[1])!=null&&p.columns&&(u.component=a[1].columns[u.propertyName]||"input"),u}),t.data.columns.push({comment:"更新时间",length:0,component:"datetime",nullable:!1,propertyName:"updateTime",type:"datetime"}),t.data.columns.push({comment:"创建时间",length:0,component:"datetime",nullable:!1,propertyName:"createTime",type:"datetime"}))})},async createVue(){const o=t.add("Vue 页面","vue");o.content="",P(t.data,c),t.tips("Vue 代码开始生成"),t.req||t.parseColumn(),t.tips("AI 分析中"),await t.req,o.content=z.createVue({...t.data,module:c.module}),await B(300),N.editor.formatCode(),t.tips("Vue 生成成功")},add(o,e){let a=t.list.find(m=>m.value==e);return a||(a=E({label:o,value:e,content:"",_content:""}),t.list.push(a)),t.active=e,a},get(o){return t.list.find(e=>e.value==o)},getContent(o){var e;return(e=t.list.find(a=>a.value==o||a.value.toLocaleLowerCase()==o.toLocaleLowerCase()))==null?void 0:e.content},async setContent(o,e,a){return new Promise(m=>{const u=t.add(o,e);if(t.lock[e]){m(u.content);return}let p=!1,v="";t.tips(`${o}生成中`),k.invokeFlow(e,{...c,...a},h=>{p=h.isEnd,h.isEnd||(v+=h.content,v.indexOf(`\`\`\`${y.tpl}
`)==0&&(u._content=v.replace(new RegExp(`^\\\`\\\`\\\`${y.tpl}\\n`,"g"),"").replace(/```$/,"")))});const S=setInterval(()=>{var q;if(i.value!="coding"){clearInterval(S);return}const h=u._content[u.content.length]||"";if(p&&!h){clearInterval(S),m(u.content),t.tips(`${o}生成成功`);return}u.content+=h,e==t.active&&((q=N.editor)==null||q.revealLine(99999))},5)})},copy(){X(t.getContent(t.active)),$.success("复制成功"),x.set("ai-code.list",t.list),x.set("ai-code.data",t.data),x.set("ai-code.form",c)},refresh(){t.list.forEach(o=>{t.lock[o.value]||(o.content="")}),t.create()}}),F=yt(()=>t.list.find(o=>o.value==t.active)),r=E({list:[],text:"",change(){switch(i.value){case"enter":r.list=["请简要描述您的功能，AI帮你写代码"];break;case"form":r.list=["准备就绪，配置预设参数"];break;default:r.list=["COOL为开发者而生","只需少量的口语提示就能完成特定的功能，大大节省开发时间"]}r.start()},set(o){r.list=o,r.start()},t1:null,t2:null,start(){r.stop();function o(e){const a=r.list[e];if(a){const m=u=>{const p=a[u];p?r.t2=setTimeout(()=>{r.text+=p,m(u+1)},60):r.t2=setTimeout(()=>{r.list.length>1&&(r.t1=setInterval(()=>{r.text=r.text.slice(0,-1),r.text||(clearInterval(r.t1),o(e+1))},50))},1500)};m(0)}else o(0)}A(r.list)||o(0)},stop(){r.t1&&clearInterval(r.t1),r.t2&&clearTimeout(r.t2),r.text=""},init(){r.change()}});function G(){return $.error("只有在开发环境下才能创建文件")}function Q(){window.open("https://cool-js.com/")}function Y(){_t.confirm(`确定要返回 ${lt.app.name} 吗？`,"提示",{type:"warning"}).then(()=>{R.back()}).catch(()=>{})}return kt(()=>{y.get(),r.init(),i.value=="coding"&&(t.list=x.get("ai-code.list")||[],x.get("ai-code.data")&&(t.data=x.get("ai-code.data")),x.get("ai-code.form")&&P(c,x.get("ai-code.form"))),vt({title:"新功能提示",message:"支持自定义修改内容，开启后跳过生成",duration:5e3})}),(o,e)=>{const a=w("el-icon"),m=w("el-button"),u=w("el-input"),p=w("cl-svg"),v=w("el-tooltip"),S=w("el-popover"),h=w("el-switch"),q=w("cl-editor"),Z=w("el-scrollbar"),tt=w("cl-form");return _(),g("div",wt,[e[26]||(e[26]=n("div",{class:"bg"},[n("div",{class:"a"}),n("div",{class:"b"})],-1)),n("div",{class:"back",onClick:Y},[l(a,null,{default:d(()=>[l(f(at))]),_:1}),e[11]||(e[11]=C(" 返回 "))]),n("div",{class:J(["panel",[`is-${i.value}`]])},[n("div",ht,[e[12]||(e[12]=n("p",{class:"title"},"Cool Ai 极速编码",-1)),e[13]||(e[13]=n("p",{class:"tag"},[C("让软件开发"),n("span",null,"再"),C("快一点")],-1)),n("p",xt,I(r.text),1)]),i.value=="start"?(_(),g("div",bt,[l(m,{class:"go btn-primary",onClick:i.next},{default:d(()=>[e[14]||(e[14]=C(" 快速开始 ")),l(a,null,{default:d(()=>[l(f(st))]),_:1})]),_:1},8,["onClick"]),l(m,{class:"doc",onClick:Q},{default:d(()=>e[15]||(e[15]=[C(" 文档 ")])),_:1})])):b("",!0),i.value=="enter"?(_(),g("div",Vt,[l(u,{ref:f(O)("inputEntity"),modelValue:c.entity,"onUpdate:modelValue":e[0]||(e[0]=s=>c.entity=s),placeholder:"如：学生信息、商品信息",onKeydown:et(i.next,["enter"])},null,8,["modelValue","onKeydown"]),i.loading?(_(),L(a,{key:0,class:"icon is-loading"},{default:d(()=>[l(f(M))]),_:1})):(_(),L(p,{key:1,class:"icon",name:"enter",onClick:i.next},null,8,["onClick"]))])):b("",!0),n("div",{class:J(["form",{show:["form","coding"].includes(i.value)}])},[n("div",Et,[n("div",Nt,[n("div",Ft,[l(v,{content:"返回"},{default:d(()=>[n("span",{onClick:e[1]||(e[1]=s=>i.prev())})]),_:1}),e[16]||(e[16]=n("span",null,null,-1)),e[17]||(e[17]=n("span",null,null,-1))])]),n("div",$t,[n("div",Lt,[n("div",It,[e[18]||(e[18]=C(" 实体名称 ")),l(v,{placement:"top",content:"指某类事物的集合名称，如：学生信息、商品信息"},{default:d(()=>[l(a,null,{default:d(()=>[l(f(D))]),_:1})]),_:1})]),l(u,{modelValue:c.entity,"onUpdate:modelValue":e[2]||(e[2]=s=>c.entity=s),maxlength:"20",placeholder:"请输入"},null,8,["modelValue"])]),n("div",Ot,[n("div",St,[e[19]||(e[19]=C(" 模块 ")),l(v,{placement:"top",content:"前、后端模块的标识，如：user、goods、demo"},{default:d(()=>[l(a,null,{default:d(()=>[l(f(D))]),_:1})]),_:1})]),l(u,{modelValue:c.module,"onUpdate:modelValue":e[3]||(e[3]=s=>c.module=s),maxlength:"20",placeholder:"请输入"},null,8,["modelValue"]),l(S,{ref:f(O)("modulePopover"),teleported:!1,"popper-style":{padding:"5px",borderRadius:"6px",zIndex:99},placement:"left"},{reference:d(()=>[l(p,{class:"add",name:"arrow-down"})]),default:d(()=>[n("div",qt,[(_(!0),g(T,null,U(f(W).dirs,(s,V)=>(_(),g("div",{key:V,class:"item",onClick:()=>{var j;c.module=s,(j=f(N).modulePopover)==null||j.hide()}},I(s),9,jt))),128))])]),_:1},512)]),n("div",Dt,[n("div",Tt,[e[20]||(e[20]=C(" 字段 ")),l(v,{placement:"top",content:"实体数据的字段名称，如：ID、姓名、手机号、状态"},{default:d(()=>[l(a,null,{default:d(()=>[l(f(D))]),_:1})]),_:1})]),l(u,{modelValue:c.column,"onUpdate:modelValue":e[4]||(e[4]=s=>c.column=s),maxlength:"200",placeholder:"请输入"},null,8,["modelValue"])]),y.value=="Node"?(_(),g("div",Ut,[n("div",Jt,[e[21]||(e[21]=C(" 其他你想做的事 ")),l(v,{placement:"top",content:"功能的扩展，如：分页查询时姓名、手机号字段设置成可模糊搜索"},{default:d(()=>[l(a,null,{default:d(()=>[l(f(D))]),_:1})]),_:1})]),l(u,{modelValue:c.other,"onUpdate:modelValue":e[5]||(e[5]=s=>c.other=s),maxlength:"200",placeholder:"请输入"},null,8,["modelValue"])])):b("",!0)])]),n("div",Wt,[l(m,{class:"btn-primary",onClick:e[6]||(e[6]=s=>t.create(!0))},{default:d(()=>[e[22]||(e[22]=C(" 生成代码 ")),l(p,{name:"code"})]),_:1})]),e[23]||(e[23]=n("div",{class:"tips"},"如遇见 “代码缺失”、“请求超时”，请尝试「刷新」吧",-1))],2),i.value=="coding"?(_(),g("div",Bt,[n("div",Mt,[n("div",Pt,[n("div",At,[l(v,{content:"返回"},{default:d(()=>[n("span",{onClick:e[7]||(e[7]=s=>i.prev())})]),_:1}),e[24]||(e[24]=n("span",null,null,-1)),e[25]||(e[25]=n("span",null,null,-1))])]),n("div",Kt,[n("div",Rt,[(_(!0),g(T,null,U(t.list,(s,V)=>(_(),g("div",{key:V,class:J(["item",{active:t.active==s.value}]),onClick:()=>{t.active=s.value}},[n("span",null,I(s.label),1),s.value!="vue"&&!t.loading?(_(),L(h,{key:0,class:"lock",size:"small",modelValue:t.lock[s.value],"onUpdate:modelValue":j=>t.lock[s.value]=j},null,8,["modelValue","onUpdate:modelValue"])):b("",!0)],10,zt))),128)),!f(A)(t.list)&&!t.loading?(_(),g("div",Ht,[l(v,{content:"重新生成"},{default:d(()=>[l(a,{onClick:e[8]||(e[8]=s=>t.refresh())},{default:d(()=>[l(f(it))]),_:1})]),_:1}),l(v,{content:"复制代码"},{default:d(()=>[l(a,{onClick:e[9]||(e[9]=s=>t.copy())},{default:d(()=>[l(f(rt))]),_:1})]),_:1}),l(v,{content:"创建文件"},{default:d(()=>[l(a,{onClick:G},{default:d(()=>[l(f(dt))]),_:1})]),_:1})])):b("",!0)]),n("div",Xt,[F.value?(_(),L(q,{ref:f(O)("editor"),key:F.value.value,modelValue:F.value.content,"onUpdate:modelValue":e[10]||(e[10]=s=>F.value.content=s),name:"cl-editor-monaco",height:"100%",border:!1,options:{theme:"ai-code--dark",minimap:{enabled:!0}},language:F.value.value=="vue"?"html":y.tpl},null,8,["modelValue","language"])):b("",!0)]),n("div",Gt,[l(Z,{ref:f(O)("console.scrollbar")},{default:d(()=>[(_(!0),g(T,null,U(t.logs,(s,V)=>(_(),g("div",{key:V,class:"item"},[n("span",Qt,I(s.date),1),n("span",Yt,I(s.text),1),t.loading&&V==t.logs.length-1?(_(),L(a,{key:0,class:"is-loading"},{default:d(()=>[l(f(M))]),_:1})):b("",!0)]))),128))]),_:1},512)])])])])):b("",!0)],2),l(tt,{ref_key:"Form",ref:H},null,512)])}}}),lo=Ct(te,[["__scopeId","data-v-e8ad3add"]]);export{lo as default};
