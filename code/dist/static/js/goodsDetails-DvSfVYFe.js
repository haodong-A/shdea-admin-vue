import{i as w}from"./comm-DyJRlPK0.js";import{h as i}from"./index-CyAmoSeV.js";import"./store@2.0.12-RoMfFez2.js";import{a as x}from"./index-4ocppgba.js";import"./@wangeditor_plugin-link-card@1.0.0_@wangeditor_editor@5.1.23_snabbdom@3.6.2-D_kdJ7Fs.js";import"./@wangeditor_editor@5.1.23-BNs7_II4.js";import{u as L,e as R}from"./vue-router@4.4.5_vue@3.5.12_typescript@5.5.4_-DGEeQixy.js";import{a as V}from"./element-plus@2.8.4_vue@3.5.12_typescript@5.5.4_-C7CHjwzj.js";import{d as b,o as q,_ as v,a0 as N,M as O,a as j,K as k,L as B,f as C,i as D}from"./@vue_runtime-core@3.5.12-Bt7zQ28n.js";import{r as m}from"./@vue_reactivity@3.5.12-vtUNgENk.js";import"./@braintree_sanitize-url@6.0.4-BB1FEM6a.js";import"./vue@3.5.12_typescript@5.5.4-kKmasoJt.js";import"./@vue_runtime-dom@3.5.12-iSYHT88p.js";import"./@vue_shared@3.5.12-UFe9jxSY.js";import"./@vueuse_core@11.1.0_vue@3.5.12_typescript@5.5.4_-BKaerpSy.js";import"./@vueuse_shared@11.1.0_vue@3.5.12_typescript@5.5.4_-DXriuop5.js";import"./lodash-es@4.17.21-D6PnhKvy.js";import"./mitt@3.0.1-C1z4c41a.js";import"./axios@1.7.7-CCb-kr4I.js";import"./nprogress@0.2.0-B8S133N7.js";import"./pinia@2.2.4_typescript@5.5.4_vue@3.5.12_typescript@5.5.4_-CVf9nHlw.js";import"./vue-demi@0.14.10_vue@3.5.12_typescript@5.5.4_-DvPnGcuI.js";import"./@bytemd_plugin-math@1.21.0_bytemd@1.21.0-Dc_JUVYX.js";import"./remark-math@5.1.1-C8vps_rM.js";import"./micromark-extension-math@2.1.2-StTlgfH1.js";import"./micromark-factory-space@1.1.0-C57A7NS2.js";import"./micromark-util-character@1.2.0-D-NaLusr.js";import"./katex@0.16.11-CvgdMzdh.js";import"./mdast-util-math@2.0.2-Boy2OOKg.js";import"./longest-streak@3.1.0-BHNUWYJP.js";import"./mdast-util-to-markdown@1.5.0-D9VzXa1u.js";import"./micromark-util-decode-string@1.1.0-CdHYbWAu.js";import"./decode-named-character-reference@1.0.2-C3-224fz.js";import"./micromark-util-decode-numeric-character-reference@1.1.0-DRnCnno4.js";import"./mockjs@1.1.0-hXCvQ4kl.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.12_echarts@5.5.1_vue@3.5.12_typescript@5.5.4_-tmE62Ovn.js";import"./echarts@5.5.1-D8FyPvXx.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.0-CH1asNwC.js";import"./@vueuse_shared@9.13.0_vue@3.5.12_typescript@5.5.4_-u9BR5ga7.js";import"./@vueuse_core@9.13.0_vue@3.5.12_typescript@5.5.4_-B3H9WZsa.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.12_typescript@5.5.4_-DwlSpvcG.js";import"./@sxzz_popperjs-es@2.11.7-DkudPAZk.js";import"./@ctrl_tinycolor@3.6.1--gef7wIN.js";import"./dayjs@1.11.13-DXimfR00.js";import"./async-validator@4.2.5-DbzRl2Zc.js";import"./memoize-one@6.0.0-DQFWdy6B.js";import"./normalize-wheel-es@1.2.0-D2sExr9L.js";import"./@floating-ui_dom@1.6.11-Db5K7U0i.js";import"./@floating-ui_core@1.6.8-B67JZAQv.js";import"./@floating-ui_utils@0.2.8-BSxVqCX2.js";import"./lodash-unified@1.0.3_@types_lodash-es@4.17.12_lodash-es@4.17.21_lodash@4.17.21-D8rsWRp7.js";const E={style:{height:"100%",width:"100%"}},F=b({name:"undefined"}),Mo=b({...F,setup(M){const{refs:l,setRefs:_}=x(),t=w.useForm(),d=m(!0),f=m([]),p=m(),y=L(),h=R(),g=m();return q(async()=>{var c;f.value=await i.goods.category.allLevel();const s=await i.goods.field.list({status:1});s&&s.length>0&&(g.value=s[0].template),(c=t.value)==null||c.open({items:[{type:"tabs",props:{type:"border-card",labels:[{label:"基础信息",value:"base"},{label:"商品参数",value:"param"}]}},{group:"base",label:"编号",prop:"goodsId",required:!0,span:16,component:{name:"el-input"}},{group:"base",label:"标题",prop:"title",required:!0,span:16,component:{name:"el-input"}},{group:"base",label:"示例图",prop:"cover",required:!0,component:{name:"cl-upload"}},{group:"base",label:"分类",prop:"category",required:!0,span:16,component:{name:"el-cascader",props:{options:f.value}}},{group:"base",label:"品牌",prop:"brand",span:16,component:{name:"el-input",props:{placeholder:"请输入品牌名称，默认SHDEA"}}},{group:"base",label:"描述",prop:"description",span:16,component:{name:"el-input",props:{type:"textarea",showWordLimit:!0,maxlength:400,autosize:{minRows:3,maxRows:10},placeholder:"请输入描述"}}},{group:"base",label:"状态",prop:"status",span:16,value:1,component:{name:"el-switch",props:{inlinePrompt:!0,style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},activeValue:1,inactiveValue:0,activeText:"上架",inactiveText:"下架"}}},{group:"param",prop:"params",component:{ref:_("params"),name:"cl-parse-input",props:{fieldOptions:g.value}}}],on:{open:async o=>{var e,r,u,a;if(p.value=(e=y.query)==null?void 0:e.id,(r=t.value)==null||r.showLoading(),p.value){const n=await i.goods.info.info({id:1});Object.assign(o,{...n,category:(u=n==null?void 0:n.category)==null?void 0:u.split(",").map(Number)})}(a=t.value)==null||a.hideLoading()},submit:async(o,{done:e,close:r})=>{var a;await(l==null?void 0:l.params.validate())||await((a=t.value)==null?void 0:a.Tabs.change("param",!1)),p.value?await i.goods.info.update({...o,id:p.value,category:o.category.join(","),params:JSON.stringify(o.params)||""}):await i.goods.info.add({...o,category:o.category.join(","),params:JSON.stringify(o.params)||""}),e(),V.success("保存成功"),await h.push({path:"/goods/info"})}}}),d.value=!1}),(s,c)=>{const o=v("cl-form"),e=v("el-scrollbar"),r=N("loading");return O((j(),k(e,{"element-loading-text":"初始化中...",style:{padding:"10px"}},{default:B(()=>[C("div",E,[D(o,{ref_key:"Form",ref:t,inner:!0},null,512)])]),_:1})),[[r,d.value]])}}});export{Mo as default};
