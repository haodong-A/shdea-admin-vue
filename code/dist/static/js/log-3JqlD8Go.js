import"./index-CyAmoSeV.js";import"./store@2.0.12-RoMfFez2.js";import{u as V}from"./index-4ocppgba.js";import"./@wangeditor_plugin-link-card@1.0.0_@wangeditor_editor@5.1.23_snabbdom@3.6.2-D_kdJ7Fs.js";import"./@wangeditor_editor@5.1.23-BNs7_II4.js";import{i as c}from"./comm-DyJRlPK0.js";import{a as l,b as D}from"./element-plus@2.8.4_vue@3.5.12_typescript@5.5.4_-C7CHjwzj.js";import{d,o as B,_ as t,a0 as E,a as u,K as _,L as r,i as o,M as K,P as N}from"./@vue_runtime-core@3.5.12-Bt7zQ28n.js";import{r as I,v as j}from"./@vue_reactivity@3.5.12-vtUNgENk.js";import"./@vue_runtime-dom@3.5.12-iSYHT88p.js";import"./@vue_shared@3.5.12-UFe9jxSY.js";import"./@braintree_sanitize-url@6.0.4-BB1FEM6a.js";import"./@vueuse_core@11.1.0_vue@3.5.12_typescript@5.5.4_-BKaerpSy.js";import"./@vueuse_shared@11.1.0_vue@3.5.12_typescript@5.5.4_-DXriuop5.js";import"./lodash-es@4.17.21-D6PnhKvy.js";import"./mitt@3.0.1-C1z4c41a.js";import"./axios@1.7.7-CCb-kr4I.js";import"./nprogress@0.2.0-B8S133N7.js";import"./pinia@2.2.4_typescript@5.5.4_vue@3.5.12_typescript@5.5.4_-CVf9nHlw.js";import"./vue-demi@0.14.10_vue@3.5.12_typescript@5.5.4_-DvPnGcuI.js";import"./vue@3.5.12_typescript@5.5.4-kKmasoJt.js";import"./@bytemd_plugin-math@1.21.0_bytemd@1.21.0-Dc_JUVYX.js";import"./remark-math@5.1.1-C8vps_rM.js";import"./micromark-extension-math@2.1.2-StTlgfH1.js";import"./micromark-factory-space@1.1.0-C57A7NS2.js";import"./micromark-util-character@1.2.0-D-NaLusr.js";import"./katex@0.16.11-CvgdMzdh.js";import"./mdast-util-math@2.0.2-Boy2OOKg.js";import"./longest-streak@3.1.0-BHNUWYJP.js";import"./mdast-util-to-markdown@1.5.0-D9VzXa1u.js";import"./micromark-util-decode-string@1.1.0-CdHYbWAu.js";import"./decode-named-character-reference@1.0.2-C3-224fz.js";import"./micromark-util-decode-numeric-character-reference@1.1.0-DRnCnno4.js";import"./vue-router@4.4.5_vue@3.5.12_typescript@5.5.4_-DGEeQixy.js";import"./mockjs@1.1.0-hXCvQ4kl.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.12_echarts@5.5.1_vue@3.5.12_typescript@5.5.4_-tmE62Ovn.js";import"./echarts@5.5.1-D8FyPvXx.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.0-CH1asNwC.js";import"./@vueuse_shared@9.13.0_vue@3.5.12_typescript@5.5.4_-u9BR5ga7.js";import"./@vueuse_core@9.13.0_vue@3.5.12_typescript@5.5.4_-B3H9WZsa.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.12_typescript@5.5.4_-DwlSpvcG.js";import"./@sxzz_popperjs-es@2.11.7-DkudPAZk.js";import"./@ctrl_tinycolor@3.6.1--gef7wIN.js";import"./dayjs@1.11.13-DXimfR00.js";import"./async-validator@4.2.5-DbzRl2Zc.js";import"./memoize-one@6.0.0-DQFWdy6B.js";import"./normalize-wheel-es@1.2.0-D2sExr9L.js";import"./@floating-ui_dom@1.6.11-Db5K7U0i.js";import"./@floating-ui_core@1.6.8-B67JZAQv.js";import"./@floating-ui_utils@0.2.8-BSxVqCX2.js";import"./lodash-unified@1.0.3_@types_lodash-es@4.17.12_lodash-es@4.17.21_lodash@4.17.21-D8rsWRp7.js";const L=d({name:"sys-log"}),Le=d({...L,setup(O){const{service:i}=V(),n=I(1),m=c.useCrud({service:i.base.sys.log},e=>{e.refresh()}),f=c.useTable({contextMenu:["refresh"],columns:[{type:"index",label:"#",width:60},{prop:"userId",label:"用户ID",minWidth:100},{prop:"name",label:"用户昵称",minWidth:120},{prop:"action",label:"请求地址",minWidth:200,showOverflowTooltip:!0},{prop:"params",label:"参数",minWidth:200,component:{name:"cl-code-json",props:{popover:!0}}},{prop:"ip",label:"ip",minWidth:150,dict:[],dictColor:!0,formatter(e){return e.ip.split(",")}},{prop:"createTime",label:"请求时间",minWidth:170,sortable:"desc"}]});function b(){i.base.sys.log.setKeep({value:n.value}).then(()=>{l.success("保存成功")}).catch(e=>{l.error(e.message)})}function h(){D.confirm("是否要清空日志？","提示",{type:"warning"}).then(()=>{i.base.sys.log.clear().then(()=>{var e;l.success("清空成功"),(e=m.value)==null||e.refresh()}).catch(e=>{l.error(e.message)})}).catch(()=>null)}return B(()=>{i.base.sys.log.getKeep().then(e=>{n.value=Number(e)})}),(e,p)=>{const g=t("cl-refresh-btn"),v=t("el-button"),y=t("el-input-number"),x=t("cl-filter"),a=t("cl-flex1"),C=t("cl-search-key"),s=t("cl-row"),w=t("cl-table"),k=t("cl-pagination"),T=t("cl-crud"),W=E("permission");return u(),_(T,{ref_key:"Crud",ref:m},{default:r(()=>[o(s,null,{default:r(()=>[o(g),K((u(),_(v,{type:"danger",onClick:h},{default:r(()=>p[1]||(p[1]=[N(" 清空 ")])),_:1})),[[W,j(i).base.sys.log.permission.clear]]),o(x,{label:"日志保存天数"},{default:r(()=>[o(y,{modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=M=>n.value=M),"controls-position":"right",max:1e4,min:1,onChange:b},null,8,["modelValue"])]),_:1}),o(a),o(C,{placeholder:"搜索请求地址、用户昵称、ip"})]),_:1}),o(s,null,{default:r(()=>[o(w,{ref_key:"Table",ref:f},null,512)]),_:1}),o(s,null,{default:r(()=>[o(a),o(k)]),_:1})]),_:1},512)}}});export{Le as default};
