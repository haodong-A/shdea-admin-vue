import{i as c}from"./comm-DyJRlPK0.js";import{o as R,c as S}from"./index-DjrkcC4y.js";import{u as A}from"./index-yy2Czm1T.js";import"./@wangeditor_plugin-link-card@1.0.0_@wangeditor_editor@5.1.23_snabbdom@3.6.2-D_kdJ7Fs.js";import"./@wangeditor_editor@5.1.23-BNs7_II4.js";import{u as K}from"./group-B_KSyv7U.js";import{A as L}from"./lodash-es@4.17.21-D6PnhKvy.js";import{d as V,b as M,a as x,K as y,L as p,_ as l,a0 as z,P as k,i as r,M as P,f as g}from"./@vue_runtime-core@3.5.12-Bt7zQ28n.js";import{O as C}from"./@vue_shared@3.5.12-UFe9jxSY.js";import{v as $}from"./@vue_reactivity@3.5.12-vtUNgENk.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./@braintree_sanitize-url@6.0.4-BB1FEM6a.js";import"./element-plus@2.8.4_vue@3.5.12_typescript@5.5.4_-C7CHjwzj.js";import"./@vueuse_shared@9.13.0_vue@3.5.12_typescript@5.5.4_-u9BR5ga7.js";import"./@vueuse_core@9.13.0_vue@3.5.12_typescript@5.5.4_-B3H9WZsa.js";import"./@vue_runtime-dom@3.5.12-iSYHT88p.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.12_typescript@5.5.4_-DwlSpvcG.js";import"./@sxzz_popperjs-es@2.11.7-DkudPAZk.js";import"./@ctrl_tinycolor@3.6.1--gef7wIN.js";import"./dayjs@1.11.13-DXimfR00.js";import"./async-validator@4.2.5-DbzRl2Zc.js";import"./memoize-one@6.0.0-DQFWdy6B.js";import"./normalize-wheel-es@1.2.0-D2sExr9L.js";import"./@floating-ui_dom@1.6.11-Db5K7U0i.js";import"./@floating-ui_core@1.6.8-B67JZAQv.js";import"./@floating-ui_utils@0.2.8-BSxVqCX2.js";import"./lodash-unified@1.0.3_@types_lodash-es@4.17.12_lodash-es@4.17.21_lodash@4.17.21-D8rsWRp7.js";import"./vue@3.5.12_typescript@5.5.4-kKmasoJt.js";import"./@vueuse_core@11.1.0_vue@3.5.12_typescript@5.5.4_-BKaerpSy.js";import"./@vueuse_shared@11.1.0_vue@3.5.12_typescript@5.5.4_-DXriuop5.js";import"./store@2.0.12-RoMfFez2.js";import"./mitt@3.0.1-C1z4c41a.js";import"./axios@1.7.7-CCb-kr4I.js";import"./nprogress@0.2.0-B8S133N7.js";import"./pinia@2.2.4_typescript@5.5.4_vue@3.5.12_typescript@5.5.4_-CVf9nHlw.js";import"./vue-demi@0.14.10_vue@3.5.12_typescript@5.5.4_-DvPnGcuI.js";import"./@bytemd_plugin-math@1.21.0_bytemd@1.21.0-Dc_JUVYX.js";import"./remark-math@5.1.1-C8vps_rM.js";import"./micromark-extension-math@2.1.2-StTlgfH1.js";import"./micromark-factory-space@1.1.0-C57A7NS2.js";import"./micromark-util-character@1.2.0-D-NaLusr.js";import"./katex@0.16.11-CvgdMzdh.js";import"./mdast-util-math@2.0.2-Boy2OOKg.js";import"./longest-streak@3.1.0-BHNUWYJP.js";import"./mdast-util-to-markdown@1.5.0-D9VzXa1u.js";import"./micromark-util-decode-string@1.1.0-CdHYbWAu.js";import"./decode-named-character-reference@1.0.2-C3-224fz.js";import"./micromark-util-decode-numeric-character-reference@1.1.0-DRnCnno4.js";import"./vue-router@4.4.5_vue@3.5.12_typescript@5.5.4_-DGEeQixy.js";import"./mockjs@1.1.0-hXCvQ4kl.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.12_echarts@5.5.1_vue@3.5.12_typescript@5.5.4_-tmE62Ovn.js";import"./echarts@5.5.1-D8FyPvXx.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.0-CH1asNwC.js";const H={class:"form-value"},J={class:"op"},Q=V({name:"dict-list"}),X=V({...Q,setup(Y){const{service:s}=A(),{dict:T}=R(),{ViewGroup:d}=K({label:"类型",title:"字典列表",service:s.dict.type,onSelect(t){W({typeId:t.id,page:1})},onEdit(){return{width:"500px",props:{labelWidth:"60px"},items:[{label:"名称",prop:"name",component:{name:"el-input",props:{maxlength:20}},required:!0},{label:"Key",prop:"key",component:{name:"el-input",props:{maxlength:20}},required:!0}]}}}),u=c.useUpsert({dialog:{width:"600px"},props:{labelWidth:"100px"},items:[{label:"上级节点",prop:"parentId",component:{name:"el-tree-select",props:{data:M(()=>{var o;const t=L((o=_.value)==null?void 0:o.data);function e(i,n){var m;i.id&&i.id==((m=u.value)==null?void 0:m.getForm("id"))&&(n=!0),n&&(i.disabled=!0),i.children&&i.children.forEach(b=>{e(b,n)})}return e({children:t},!1),t}),props:{label:"name",value:"id",children:"children",disabled:"disabled"},clearable:!0,filterable:!0,"default-expand-all":!0,"check-strictly":!0}}},{label:"名称",prop:"name",required:!0,component:{name:"el-input"}},{label:"值",prop:"value",component:{name:"slot-value"}},{label:"排序",prop:"orderNum",value:1,component:{name:"el-input-number",props:{min:1}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],onSubmit(t,{next:e}){var o,i;e({...t,typeId:(i=(o=d.value)==null?void 0:o.selected)==null?void 0:i.id})},plugins:[c.setFocus("name")]}),_=c.useTable({contextMenu:["refresh",t=>{var e;return{label:"新增",hidden:!((e=s.dict.info._permission)!=null&&e.add),callback(o){v(t),o()}}},"edit","delete","order-asc","order-desc"],columns:[{type:"selection"},{label:"名称",prop:"name",align:"left",minWidth:200},{label:"ID",prop:"id",minWidth:120},{label:"值",prop:"value",minWidth:200,showOverflowTooltip:!0},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:170},{label:"排序",prop:"orderNum",sortable:"desc",width:100,fixed:"right"},{label:"创建时间",prop:"createTime",sortable:"custom",minWidth:170},{label:"更新时间",prop:"updateTime",sortable:"custom",minWidth:170},{type:"op",width:250,buttons:["slot-btn","edit","delete"]}]}),f=c.useCrud({service:s.dict.info,onRefresh(t,{render:e}){s.dict.info.list({...t,page:void 0,size:void 0}).then(o=>{var i,n;e(S(o,t.sort)),T.refresh([(n=(i=d.value)==null?void 0:i.selected)==null?void 0:n.key])})}});function W(t){var e;(e=f.value)==null||e.refresh(t)}function D(t,e){var o;e!=null&&e.property&&t.children&&((o=_.value)==null||o.toggleRowExpansion(t))}function v(t){var e;(e=f.value)==null||e.rowAppend({parentId:t.id,orderNum:1})}function I(t){var e,o;(o=u.value)==null||o.setForm("value",(e=t[0])==null?void 0:e.url)}return(t,e)=>{const o=l("cl-refresh-btn"),i=l("cl-add-btn"),n=l("cl-multi-delete-btn"),m=l("cl-flex1"),b=l("cl-search-key"),h=l("cl-row"),N=l("el-button"),U=l("cl-table"),E=l("el-input"),F=l("cl-upload-space"),q=l("cl-upsert"),B=l("cl-crud"),G=l("cl-view-group"),O=z("permission");return x(),y(G,{ref_key:"ViewGroup",ref:d},{"item-name":p(({item:a})=>[k(C(a.name)+" - "+C(a.key),1)]),right:p(()=>[r(B,{ref_key:"Crud",ref:f},{default:p(()=>[r(h,null,{default:p(()=>[r(o),r(i),r(n),r(m),r(b,{placeholder:"搜索名称"})]),_:1}),r(h,null,{default:p(()=>[r(U,{ref_key:"Table",ref:_,"row-key":"id",onRowClick:D},{"slot-btn":p(({scope:a})=>[P((x(),y(N,{text:"",bg:"",type:"success",onClick:w=>v(a.row)},{default:p(()=>e[0]||(e[0]=[k("新增")])),_:2},1032,["onClick"])),[[O,$(s).dict.info.permission.add]])]),_:1},512)]),_:1}),r(h,null,{default:p(()=>[r(m)]),_:1}),r(q,{ref_key:"Upsert",ref:u},{"slot-value":p(({scope:a})=>[g("div",H,[r(E,{modelValue:a.value,"onUpdate:modelValue":w=>a.value=w,placeholder:"请填写值",clearable:"",type:"textarea",rows:4},null,8,["modelValue","onUpdate:modelValue"]),g("div",J,[r(F,{text:"使用文件",limit:1,onConfirm:I})])])]),_:1},512)]),_:1},512)]),_:1},512)}}}),Ze=j(X,[["__scopeId","data-v-f2b3a46f"]]);export{Ze as default};
